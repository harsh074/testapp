var askmonkApp=angular.module("askmonkApp",["ionic","ionMdInput","ionic-datepicker","ionic.rating","tabSlideBox","monospaced.elastic","ion-google-place","ionic-timepicker"]);askmonkApp.run(["$ionicPlatform","$state","$stateParams","CONSTANT","$timeout",function(e,o,t,n,a){localStorage.getItem("token")?localStorage.profile?"underObservation"==localStorage.getItem("questionStatus")?(t.id=localStorage.getItem("questionId"),o.go("app.singlequestion",t)):o.go("app.dashboard"):o.go("app.profile"):o.go("login"),e.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),window.MobileAccessibility&&window.MobileAccessibility.usePreferredTextZoom(!1),window.StatusBar&&(window.StatusBar.overlaysWebView(!0),window.StatusBar.backgroundColorByHexString("#000")),a(function(){navigator&&navigator.splashscreen&&navigator.splashscreen.hide(),window.navigator&&window.navigator.splashscreen&&window.navigator.splashscreen.hide()},2e3),n.isDevice=ionic.Platform.device().available,n.isDevice&&(window.plugins.nativepagetransitions.globalOptions.duration=100,window.plugins.nativepagetransitions.globalOptions.androiddelay=0,window.plugins.nativepagetransitions.globalOptions.fixedPixelsTop=0,window.plugins.nativepagetransitions.globalOptions.fixedPixelsBottom=0)}),n.PRODUCTION_MODE&&(window.console&&window.console.log&&(window.console.log=function(){}),window.alert&&(window.alert=function(){}))}]),askmonkApp.config(["$stateProvider","$urlRouterProvider","$ionicConfigProvider",function(e,o,t){t.views.transition("none"),t.views.swipeBackEnabled(!1),e.state("login",{url:"/login",cache:!1,templateUrl:"views/login.html",controller:"loginCtrl"}).state("app",{url:"/app","abstract":!0,cache:!1,templateUrl:"views/sidemenu.html",controller:"appCtrl"}).state("app.profile",{url:"/profile",cache:!1,views:{menuContent:{templateUrl:"views/profile.html",controller:"profileCtrl"}}}).state("app.yprofiles",{url:"/yogi-profiles",cache:!1,views:{menuContent:{templateUrl:"views/yogi-profiles-tile.html",controller:"yProfilesCtrl"}}}).state("app.yprofile",{url:"/yogi-profile/{id}",cache:!1,views:{menuContent:{templateUrl:"views/yogi-profile.html",controller:"yProfileCtrl"}}}).state("app.directQuestion",{url:"/direct-question",cache:!1,views:{menuContent:{templateUrl:"views/directQuestion.html",controller:"directQuestionCtrl"}}}).state("app.openQuestion",{url:"/open-question",cache:!1,views:{menuContent:{templateUrl:"views/openQuestion.html",controller:"openQuestionCtrl"}}}).state("app.wallet",{url:"/wallet",cache:!1,views:{menuContent:{templateUrl:"views/wallet.html",controller:"walletCtrl"}}}).state("app.setting",{url:"/setting",cache:!1,views:{menuContent:{templateUrl:"views/setting.html",controller:"settingCtrl"}}}).state("app.editProfile",{url:"/editprofile",cache:!1,views:{menuContent:{templateUrl:"views/editProfile.html",controller:"editProfileCtrl"}}}).state("app.askQuestion",{url:"/askquestion",cache:!1,views:{menuContent:{templateUrl:"views/askQuestion.html",controller:"askQuestionCtrl"}}}).state("app.dashboard",{url:"/dashboard",cache:!1,views:{menuContent:{templateUrl:"views/dashboard.html",controller:"dashboardCtrl"}}}).state("app.singlequestion",{url:"/singlequestion/{id}",cache:!1,views:{menuContent:{templateUrl:"views/singleQuestion.html",controller:"singleQuestionCtrl"}}}).state("app.horoscope",{url:"/dailyHoroscope",cache:!1,views:{menuContent:{templateUrl:"views/allHoroscope.html",controller:"horoscopeCtrl"}}})}]),askmonkApp.constant("CONSTANT",{baseUrl:"http://askmonk.in:3000",isComingFromSignUp:!1,isDevice:!1,loginType:null,pushSenderID:"915609605128",PRODUCTION_MODE:!0}),askmonkApp.controller("askQuestionCtrl",["$scope","$state","utility","$ionicScrollDelegate","$timeout","CONSTANT","$ionicPopup","$ionicModal",function(e,o,t,n,a,i,s,r){function l(e){a(function(){n.$getByHandle("scrollHandle").resize(),n.$getByHandle("scrollHandle").scrollBottom(!0)},150)}function u(o){e.showDate=!0,o?e.datepickerObject.inputDate=o:e.datepickerObject.inputDate=new Date,e.args.partnerDOB=angular.copy(e.datepickerObject.inputDate)}function c(o){if(angular.element(document.getElementsByClassName("ion-birth-time")).addClass("used"),"undefined"==typeof o)e.args.partnerBirthTime=new Date;else{var t=new Date(1e3*o);e.args.partnerBirthTime=new Date,e.args.partnerBirthTime.setMinutes(t.getUTCMinutes()),e.args.partnerBirthTime.setHours(t.getUTCHours())}}e.$on("$ionicView.enter",function(){});var g;window.addEventListener("native.keyboardshow",l),window.addEventListener("native.keyboardhide",l),e.args={partnerName:"",partnerBirthPlace:"",partnerBirthTime:"",partnerDOB:"",partnerGender:""},e.showQuestion=!0,e.askQuestion={email:localStorage.getItem("email"),userId:localStorage.getItem("userId"),question:"",questionTag:"",isDirect:!1,moneyType:""},e.askOtherQuestion={question:null},e.showOnOtherQuestion=!1,e.datepickerObject={titleLabel:"DOB",todayLabel:"Today",closeLabel:"Close",setLabel:"Set",setButtonType:"button-askmonk",todayButtonType:"button-askmonk",closeButtonType:"button-askmonk",inputDate:e.args.partnerDOB?new Date(e.args.partnerDOB):new Date,mondayFirst:!0,templateType:"popup",showTodayButton:"false",modalHeaderColor:"bar-positive",modalFooterColor:"bar-positive",from:new Date(1940,1,1),to:new Date,callback:function(e){u(e)},dateFormat:"dd-MM-yyyy",closeOnSelect:!0},e.timePickerObject12Hour={inputEpochTime:e.args.partnerBirthTime?60*new Date(e.args.partnerBirthTime).getHours()*60+60*new Date(e.args.partnerBirthTime).getMinutes():60*(new Date).getHours()*60,step:1,format:12,titleLabel:"Partner Birth Time",closeLabel:"Close",setLabel:"Set",setButtonType:"button-askmonk",closeButtonType:"button-askmonk",callback:function(e){c(e)}},"user"==e.loginType&&(e.showLoader(),t.getUserCount().then(function(o){e.hideLoader(),console.log(o),e.getUserCount=o},function(o){422==o.error.statusCode&&e.showMessage(o.error.message),e.hideLoader(),console.log(o)}),localStorage.timelineJson?e.timeLineJson=JSON.parse(localStorage.timelineJson):t.getTimeLineJson().then(function(o){e.timeLineJson=o,localStorage.setItem("timelineJson",JSON.stringify(o))},function(o){422==o.error.statusCode&&e.showMessage(o.error.message),console.log(o)})),localStorage.tagQuestion?e.questions=JSON.parse(localStorage.getItem("tagQuestion")):(e.showLoader(),t.getAllQuestion().then(function(o){e.questions=o,localStorage.setItem("tagQuestion",JSON.stringify(o))},function(o){422==o.error.statusCode&&e.showMessage(o.error.message),e.hideLoader(),console.log(o)})),e.selectedTimeline={value:"basic"},e.timeLineValueSelected="6",e.selectTimelineOption=function(){e.getUserCount.totalQuestionsAsked?e.timeLinePopup=s.show({cssClass:"timelineSelector",title:"Duration : Rate Card",templateUrl:"selectTimelinePopup.html",scope:e}):!e.getUserCount.makeFirstQuestionHalfRate&&e.getUserCount.makeFirstQuestionFree?e.showMessage("Free question has fixed duration of 6 months"):e.timeLinePopup=s.show({cssClass:"timelineSelector",title:"Duration : Rate Card",templateUrl:"selectTimelinePopup.html",scope:e})},e.askQuestionCategory=function(o,t){e.askQuestion.question="",e.showOnOtherQuestion=!1,"other"!=t?(e.askOtherQuestion.question=null,e.showQuestion=!0,e.preffredQuestion=angular.copy(e.questions[t]),a(function(){n.$getByHandle("scrollHandle").resize()},250)):(e.showQuestion=!1,a(function(){cordova.plugins.Keyboard.show()},200))},e.clearQuestionOnOther=function(){e.askQuestion.question==e.preffredQuestion[e.preffredQuestion.length-1]?(e.askOtherQuestion.question=null,e.showOnOtherQuestion=!0):(e.askOtherQuestion.question=null,e.showOnOtherQuestion=!1,a(function(){n.$getByHandle("scrollHandle").resize()},250),angular.element(g).css("margin-bottom","0px"))},e.addPartnerDetailsModal=function(){r.fromTemplateUrl("views/partnerDetailsModal.html",function(o){e.partnerDetailsModal=o,e.partnerDetailsModal.show()},{scope:e,animation:"slide-in-up",hardwareBackButtonClose:!0})},e.openAskQuestion=function(){console.log(e.askQuestion.moneyType);var o=s.show({cssClass:"ios",title:"Going further would send the question to the astrologers",template:"Do u wish to continue ?",buttons:[{text:"Yes",type:"button-ios button-clear",onTap:function(e){return!0}},{text:"No",type:"button-ios button-clear",onTap:function(e){return!1}}]});o.then(function(o){o?(console.log("You are sure"),e.getUserCount.emailVerified?e.askQuestionButton():e.showMessage("Please verify your email")):console.log("You are not sure")})},e.money={customMoney:""},e.options=function(){e.amount=100*e.money.customMoney;var o=JSON.parse(localStorage.profile),t={description:"Ask Question",currency:"INR",key:"rzp_test_2jGmoGfR3KHvoA",amount:e.amount,name:"Askmonk",prefill:{email:o.email,contact:o.mobile,name:o.name},theme:{color:"#00BCD2"}};return t};var d=function(o){o?(e.showLoader(),t.addMoney({userId:localStorage.userId,email:localStorage.email,amount:e.amount,payment_id:o}).then(function(o){e.hideLoader(),e.showMessage("Transaction successful"),localStorage.profile=JSON.stringify(o),e.askQuestionButton()},function(o){e.hideLoader(),o?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})):e.showMessage("Something went wrong. Try again")},m=function(o){e.showMessage(o.description)};e.openInsufficientPopup=function(){var o=s.show({cssClass:"ios",title:"Insufficient Funds. Please pay to continue asking",template:'<ion-md-input name="addMoney" type="tel" placeholder="Rs." highlight-color="calm" ng-pattern="/^[0-9]+$/" ng-model="money.customMoney" ng-disabled="true"></ion-md-input>',scope:e,buttons:[{text:"Yes",type:"button-ios button-clear",onTap:function(e){return!0}},{text:"No",type:"button-ios button-clear",onTap:function(e){return!1}}]});o.then(function(o){o?(RazorpayCheckout.open(e.options(),d,m),console.log("You are sure")):console.log("You are not sure")})},e.askQuestionButton=function(){if(e.showLoader(),e.askOtherQuestion.question&&(e.askQuestion.question=null,e.askQuestion.question=angular.copy(e.askOtherQuestion.question),e.hideLoader()),localStorage.getItem("directQuestion")&&angular.extend(e.askQuestion,JSON.parse(localStorage.getItem("directQuestion"))),"Match Making"==e.askQuestion.questionTag){if(!(e.args.partnerName&&e.args.partnerBirthPlace&&e.args.partnerBirthTime&&e.args.partnerDOB&&e.args.partnerGender))return e.hideLoader(),e.addPartnerDetailsModal(),void e.showMessage("Partner details are required");e.askQuestion.matchMakingDetails=angular.copy(e.args)}e.askQuestion.question?(e.askQuestion.moneyType=angular.copy(e.selectedTimeline.value),localStorage.getItem("directQuestion")?t.askDirectQuestion(e.askQuestion).then(function(n){t.getUserCount().then(function(t){var n=JSON.parse(localStorage.profile);n.totalQuestionsAsked=t.totalQuestionsAsked,n.walletMoney=t.walletMoney,localStorage.profile=JSON.stringify(n),o.go("app.dashboard"),e.transitionAnimation("left",900)},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},function(o){e.hideLoader(),0==o.error.message.indexOf("Insufficient Funds")?(console.log(e.getUserCount),e.showMessage(o.error.message),e.getUserCount&&e.getUserCount.walletMoney?e.money.customMoney=e.timeLineJson[e.askQuestion.moneyType].amount-e.getUserCount.walletMoney:e.money.customMoney=e.timeLineJson[e.askQuestion.moneyType].amount,e.openInsufficientPopup()):o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}):t.askQuestion(e.askQuestion).then(function(n){t.getUserCount().then(function(t){var n=JSON.parse(localStorage.profile);n.totalQuestionsAsked=t.totalQuestionsAsked,n.walletMoney=t.walletMoney,localStorage.profile=JSON.stringify(n),o.go("app.dashboard"),e.transitionAnimation("left",900)},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},function(o){e.hideLoader(),0==o.error.message.indexOf("Insufficient Funds")?(console.log(e.getUserCount),e.showMessage(o.error.message),e.getUserCount&&e.getUserCount.walletMoney?e.money.customMoney=e.timeLineJson[e.askQuestion.moneyType].amount-e.getUserCount.walletMoney:e.money.customMoney=e.timeLineJson[e.askQuestion.moneyType].amount,e.openInsufficientPopup()):o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})):(e.hideLoader(),e.showMessage("Please ask the desired question"))},e.cancelAskQuestion=function(){o.go("app.dashboard")},e.closeModal=function(){e.partnerDetailsModal&&e.partnerDetailsModal.isShown()&&e.partnerDetailsModal.remove()},e.goToWalletFromModal=function(){e.closeModal(),o.go("app.wallet")},e.changePopValue=function(){e.timeLineValueSelected=angular.copy(e.timeLineJson[e.selectedTimeline.value].durationMonths),a(function(){e.timeLinePopup.close()},100)}}]),askmonkApp.filter("timeLineFiter",function(){return function(e){return 6==e?"1/2 Year":1==parseInt(e/12)?parseInt(e/12)+"  Year":parseInt(e/12)+"  Years"}}),askmonkApp.controller("partnerDetailsModal",["$scope","$timeout",function(e,o){o(function(){e.args.partnerBirthPlace&&angular.element(document.getElementsByClassName("ion-google-place")).addClass("used"),e.args.partnerBirthTime&&angular.element(document.getElementsByClassName("ion-birth-time")).addClass("used")},50)}]),askmonkApp.controller("appCtrl",["$scope","CONSTANT","$state","utility","$rootScope","$timeout",function(e,o,t,n,a,i){e.isComingFromSignUp=o.isComingFromSignUp,e.loginType=o.loginType,e.$on("updateEditProfileFirstUser",function(){e.isComingFromSignUp=o.isComingFromSignUp,o.isComingFromSignUp&&e.showMessage("Please fill details to move further")}),e.$on("writeAnswerActive",function(){e.isComingFromSignUp=o.isComingFromSignUp,o.isComingFromSignUp&&e.showMessage("Write your answer")}),e.sideMenuName=localStorage.getItem("name"),e.$on("updateSideMenuName",function(t,n){e.loginType=o.loginType,e.sideMenuName=localStorage.getItem("name")}),e.goToWallet=function(){t.go("app.wallet"),e.transitionAnimation("left",500)},"monk"==o.loginType&&(e.isAvailable={},localStorage.profile&&(e.isAvailable.status=JSON.parse(localStorage.profile).isAvailable)),e.$on("updateAvaliableStatus",function(){e.isAvailable={},e.isAvailable.status=JSON.parse(localStorage.profile).isAvailable}),e.changeAvaliableStatus=function(){e.profileData=JSON.parse(localStorage.profile),n.updateMonkAvailableStatus({id:e.profileData.id,email:e.profileData.email,isAvailable:e.isAvailable.status}).then(function(e){localStorage.profile=JSON.stringify(e),a.profileData=angular.copy(e)},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o,"error")})}}]),askmonkApp.controller("bodyCtrl",["$scope","utility","CONSTANT","$rootScope","CONSTANT","$ionicLoading","$timeout","$ionicHistory","$state","$ionicSideMenuDelegate","$ionicPlatform","$stateParams",function(e,o,t,n,t,a,i,s,r,l,u,c){function g(){e.authenticated&&e.registerNotificaton(),console.log("deviceReady"),document.addEventListener("online",m,!1),document.addEventListener("offline",d,!1),i(function(){console.log(sessionStorage.redirectFromUrl,"session"),5==sessionStorage.redirectFromUrl.split("askmonk://")[1]?i(function(){e.showMessage("Email validated. Happy askmonking")}):r.go("app.singlequestion",{id:sessionStorage.redirectFromUrl.split("askmonk://")[1]})},300),window.screen&&window.screen.lockOrientation&&window.screen.lockOrientation("portrait")}function d(){e.showMessage("Internet Connectivity error please try again")}function m(){console.log("online")}document.addEventListener("deviceready",g,!1),e.showArrow=!1,e.showMessage=function(e){window.plugins.toast.showWithOptions({message:e,duration:"long",position:"bottom",addPixelsY:-20},function(){console.log("sucess")},function(){console.log("error")})},e.registerNotificaton=function(){"android"===device.platform.toLowerCase()&&window.plugins.pushNotification.register(function(){},function(){alert("Push Notification registration FAIL on Android")},{ecb:"window.onNotificationGCM",senderID:t.pushSenderID})},window.onNotificationGCM=function(o){"message"==o.event?(console.log(o,e.authenticated),o.payload.questionId&&e.authenticated&&(12==o.payload.questionId?r.go("app.horoscope"):1==o.payload.questionId?r.go("app.askQuestion"):r.go("app.singlequestion",{id:o.payload.questionId}))):"registered"===o.event?window.registrationHandler(o.regid):"error"===o.event&&console.log("error",o)},window.registrationHandler=function(t){e.deviceInfo={deviceType:window.device.platform,userId:localStorage.userId,deviceId:t},o.notification(e.deviceInfo).then(function(e){console.log("success",JSON.stringify(e))},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},u.onHardwareBackButton(function(){"login"==s.currentStateName()||s.goBack()},150),o.initialize(t.baseUrl,!1,e,n),e.showLoader=function(e){a.show({animation:"fade-in",showBackdrop:!1,template:'<ion-spinner icon="ripple" class="spinner-askmonk"></ion-spinner>'})},e.hideLoader=function(){function e(e){}function o(e){}a.hide(),t.isDevice&&window.cache.clear(e,o)},e.transitionAnimation=function(e,o){window.plugins.nativepagetransitions.slide({direction:e,androiddelay:o},function(e){console.log("success: "+e)},function(e){alert("error: "+e)})},e.transitionAnimationUp=function(e){i(function(){window.plugins.nativepagetransitions.slide({direction:"up"},function(e){console.log("success: "+e)},function(e){alert("error: "+e)})},e?e:500)},e.hamburgerBtnEvent=function(){"app.editProfile"==r.current.name||"app.askQuestion"==r.current.name||"app.yprofile"==r.current.name||"app.singlequestion"==r.current.name?(i(function(){s.goBack()},300),"app.yprofile"==r.current.name||"app.askQuestion"==r.current.name||"app.singlequestion"==r.current.name?e.transitionAnimation("right",900):e.transitionAnimation("right",650)):l.toggleLeft()},e.$on("$stateChangeStart",function(o,t,n,a,i){"app.yprofile"!=a.name&&"app.askQuestion"!=t.name&&localStorage.removeItem("directQuestion"),"app.editProfile"==t.name||"app.askQuestion"==t.name||"app.yprofile"==t.name||"app.singlequestion"==t.name?e.showArrow=!0:e.showArrow=!1}),t.loginType=localStorage.getItem("loginType")}]),askmonkApp.controller("dashboardCtrl",["$scope","$state","utility","$timeout","$stateParams","CONSTANT","$ionicSlideBoxDelegate","$ionicGesture","$ionicScrollDelegate",function(e,o,t,n,a,i,s,r,l){function u(o){"native.keyboardshow"==o.type?e.floatingBtnAction=!1:e.floatingBtnAction=!0}"underObservation"==localStorage.questionStatus&&(e.showArrow=!0,o.go("app.singlequestion",{id:localStorage.questionId})),localStorage.profile||o.go("app.profile"),e.noQuestionFound=!1,e.search={searchInput:""},e.question={askedQuestion:[],answeredQuestion:[],ratedQuestion:[]},e.floatingBtnAction=!1,e.$on("$ionicView.enter",function(){e.floatingBtnAction=!0,e.showLoader()}),window.addEventListener("native.keyboardshow",u),window.addEventListener("native.keyboardhide",u),e.loginType=i.loginType,e.showClear=!1,e.noMoreAskedQuestion=!1,e.noMoreOtherQuestion=!1,e.showInfinteScroll=!1;var c=0,g=0;n(function(){s.$getByHandle("sliderScroll").enableSlide(!1),r.on("swiperight",function(e){1==s.$getByHandle("sliderScroll").currentIndex()?(s.$getByHandle("sliderScroll").previous(),l.$getByHandle("slide1Scroll").scrollTop(!0)):2==s.$getByHandle("sliderScroll").currentIndex()&&(s.$getByHandle("sliderScroll").previous(),l.$getByHandle("slide2Scroll").scrollTop(!0))},angular.element(document.querySelector("#sliderScroll"))),r.on("swipeleft",function(e){0==s.$getByHandle("sliderScroll").currentIndex()?(s.$getByHandle("sliderScroll").next(),l.$getByHandle("slide2Scroll").scrollTop(!0)):1==s.$getByHandle("sliderScroll").currentIndex()&&(s.$getByHandle("sliderScroll").next(),l.$getByHandle("slide3Scroll").scrollTop(!0))},angular.element(document.querySelector("#sliderScroll")))},500),e.questionSorted=function(o){e.question={askedQuestion:[],answeredQuestion:[],ratedQuestion:[]},angular.forEach(o,function(o,t){"asked"==o.status||"direct"==o.status?e.question.askedQuestion.push(o):"answered"==o.status?e.question.answeredQuestion.push(o):e.question.ratedQuestion.push(o)})},e.questionSortedMonk=function(o,t,n){"pullToRefresh"==n&&("asked"==t?e.question.askedQuestion=[]:"answered"==t?(e.question.answeredQuestion=[],e.question.ratedQuestion=[]):e.question={askedQuestion:[],answeredQuestion:[],ratedQuestion:[]}),angular.forEach(o,function(o,t){"asked"==o.status?e.question.askedQuestion.push(o):"answered"==o.status?e.question.answeredQuestion.push(o):e.question.ratedQuestion.push(o)})},e.askQuestion=function(){o.go("app.askQuestion"),e.transitionAnimation("left",500)},"user"==e.loginType?t.getUserQuestions().then(function(o){n(function(){e.hideLoader()}),o.length>0&&e.questionSorted(o),t.getUserCount().then(function(o){e.getUserCount=o},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)}):t.getMonkAnsweredQuestion(g).then(function(o){n(function(){e.hideLoader()}),e.questionSortedMonk(o,null,null),n(function(){e.showInfinteScroll=!0},1e3)},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}),e.loadMoreAskedQuestion=function(){c+=10,e.showLoader(),t.getQuestionOnStatus("asked",c).then(function(o){console.log(o,"asked"),e.hideLoader(),0==o.length&&c>9?(e.noQuestionFound=!0,e.noMoreAskedQuestion=!0,e.$broadcast("scroll.infiniteScrollComplete")):(e.questionSortedMonk(o,null,null),e.$broadcast("scroll.infiniteScrollComplete"))},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},e.loadMoreOtherQuestion=function(){g+=10,e.showLoader(),t.getMonkAnsweredQuestion(g).then(function(o){e.hideLoader(),console.log(o,"answered"),0==o.length&&g>9?(e.noMoreOtherQuestion=!0,e.$broadcast("scroll.infiniteScrollComplete")):(e.questionSortedMonk(o,null,null),e.$broadcast("scroll.infiniteScrollComplete"))},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.doRefresh=function(){c=0,e.noMoreAskedQuestion=!1,"user"==e.loginType?t.getUserQuestions().then(function(o){console.log(o),e.$broadcast("scroll.refreshComplete"),o.length>0?e.questionSorted(o):e.noQuestionFound=!0},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)}):t.getQuestionOnStatus("asked",c).then(function(o){e.$broadcast("scroll.refreshComplete"),o.length>0?e.questionSortedMonk(o,"asked","pullToRefresh"):e.noQuestionFound=!0},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.doRefreshOnAnsweredTab=function(){g=0,e.noMoreOtherQuestion=!1,"user"==e.loginType?t.getUserQuestions().then(function(o){console.log(o),e.$broadcast("scroll.refreshComplete"),o.length>0?e.questionSorted(o):e.noQuestionFound=!0},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}):t.getMonkAnsweredQuestion(g).then(function(o){e.$broadcast("scroll.refreshComplete"),e.questionSortedMonk(o,"answered","pullToRefresh")},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},e.slideHasChanged=function(e){console.log(e)},e.goToQuestion=function(t){a.id=t,o.go("app.singlequestion",a),e.transitionAnimation("left",700)},e.inputSearch=function(){e.search.searchInput?e.showClear=!0:e.showClear=!1},e.clearSearch=function(){e.search.searchInput="",e.showClear=!1}}]),askmonkApp.controller("directQuestionCtrl",["$scope","utility","$state","$stateParams",function(e,o,t,n){e.noQuestionFound=!1,e.search={searchInput:""},e.showClear=!1,e.$on("$ionicView.enter",function(){e.showLoader()});var a=0;e.noMoreQuestion=!1,o.getDirectQuestion(a).then(function(o){e.hideLoader(),console.log(o),o.length>0?e.groups=o:e.noQuestionFound=!0},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}),e.doRefresh=function(){a=0,e.noMoreQuestion=!1,o.getDirectQuestion(a).then(function(o){e.$broadcast("scroll.refreshComplete"),console.log(o),o.length>0?e.groups=o:e.noQuestionFound=!0},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.loadMoreQuestion=function(){a+=10,e.showLoader(),o.getDirectQuestion(a).then(function(o){e.hideLoader(),console.log(o,"answered"),0==o.length&&a>9?(e.noMoreQuestion=!0,e.$broadcast("scroll.infiniteScrollComplete")):(angular.forEach(o,function(o,t){e.groups.push(o)}),e.$broadcast("scroll.infiniteScrollComplete"))},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.goToQuestion=function(o){n.id=o,t.go("app.singlequestion",n),e.transitionAnimation("left",700)},e.inputSearch=function(){e.search.searchInput?e.showClear=!0:e.showClear=!1},e.clearSearch=function(){e.showClear=!1,e.search.searchInput=""}}]),askmonkApp.controller("editProfileCtrl",["$scope","$state","CONSTANT","$rootScope","utility","$timeout","getMoonSign",function(e,o,t,n,a,i,s){function r(o){e.showDate=!0,o?e.datepickerObject.inputDate=o:e.datepickerObject.inputDate=new Date,e.editProfileData.dob=angular.copy(e.datepickerObject.inputDate)}function l(o){if(angular.element(document.getElementsByClassName("ion-birth-time")).addClass("used"),"undefined"==typeof o)e.editProfileData.birthTime=new Date;else{var t=new Date(1e3*o);e.editProfileData.birthTime=new Date,e.editProfileData.birthTime.setMinutes(t.getUTCMinutes()),e.editProfileData.birthTime.setHours(t.getUTCHours())}}e.authenticated&&(e.$on("$ionicView.enter",function(){e.showLoader()}),e.loginType=t.loginType,i(function(){e.hideLoader()},400),"user"==e.loginType&&a.getUserCount().then(function(o){e.getUserCount=o},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)}),e.showDate=!1,t.isComingFromSignUp&&e.$emit("updateEditProfileFirstUser"),n.profileData?(e.editProfileData=angular.copy(n.profileData),"user"==e.loginType&&(e.editProfileData.birthTime&&(e.editProfileData.birthTime=new Date(e.editProfileData.birthTime)),e.showDate=!0)):localStorage.getItem("profileData")?e.editProfileData=JSON.parse(localStorage.getItem("profileData")):e.editProfileData={},console.log(e.editProfileData),i(function(){e.editProfileData.birthPlace&&angular.element(document.getElementsByClassName("ion-google-place")).addClass("used"),e.editProfileData.birthTime&&angular.element(document.getElementsByClassName("ion-birth-time")).addClass("used")},50),e.datepickerObject={titleLabel:"DOB",todayLabel:"Today",closeLabel:"Close",setLabel:"Set",setButtonType:"button-askmonk",todayButtonType:"button-askmonk",closeButtonType:"button-askmonk",inputDate:e.editProfileData.dob?new Date(e.editProfileData.dob):new Date,mondayFirst:!0,templateType:"popup",showTodayButton:"false",modalHeaderColor:"bar-positive",modalFooterColor:"bar-positive",from:new Date(1940,1,1),to:new Date,callback:function(e){r(e)},dateFormat:"dd-MM-yyyy",closeOnSelect:!0},e.timePickerObject12Hour={inputEpochTime:e.editProfileData.birthTime?60*new Date(e.editProfileData.birthTime).getHours()*60+60*new Date(e.editProfileData.birthTime).getMinutes():60*(new Date).getHours()*60,step:1,format:12,titleLabel:"Birth Time",closeLabel:"Close",setLabel:"Set",setButtonType:"button-askmonk",closeButtonType:"button-askmonk",callback:function(e){l(e)}},e.expandText=function(){var e=document.getElementById("bioTextarea");e.style.height=e.scrollHeight+"px"},e.saveEditProfile=function(){if(e.showLoader(),"user"==e.loginType){if(!(e.editProfileData.dob&&e.editProfileData.birthPlace&&e.editProfileData.birthTime&&e.editProfileData.gender&&e.editProfileData.mobile&&e.editProfileData.name&&e.editProfileData.maritalStatus&&e.editProfileData.profession&&e.editProfileData.qualification&&e.editProfileData.numberOfChildren))return e.hideLoader(),void e.showMessage("All fields are required");if(10!=e.editProfileData.mobile.toString().length)return e.hideLoader(),void e.showMessage("Please enter the valid mobile number");a.updateUserProfile(s(e.editProfileData)).then(function(n){e.hideLoader(),t.isComingFromSignUp=!1,localStorage.removeItem("profileData"),localStorage.setItem("name",e.editProfileData.name),localStorage.setItem("profile",JSON.stringify(n)),e.$emit("updateEditProfileFirstUser"),o.go("app.profile"),e.getUserCount.emailVerified||e.showMessage("Email Sent. Please Verify!"),e.transitionAnimation("left",500)},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})}else{if(!(e.editProfileData.name&&e.editProfileData.phone&&e.editProfileData.education&&e.editProfileData.residence&&e.editProfileData.experience&&e.editProfileData.city&&e.editProfileData.state&&e.editProfileData.country))return e.hideLoader(),void e.showMessage("All fields are required");a.updateMonkProfile(e.editProfileData).then(function(n){e.hideLoader(),t.isComingFromSignUp=!1,localStorage.removeItem("profileData"),localStorage.setItem("name",e.editProfileData.name),localStorage.setItem("profile",JSON.stringify(n)),e.$emit("updateEditProfileFirstUser"),o.go("app.profile"),e.transitionAnimation("left",500)},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})}})}]),askmonkApp.controller("horoscopeCtrl",["$scope","$ionicModal","$state",function(e,o,t){e.zodiacSigns=[{id:1,name:"Aries",imagePath:"img/moonSign/icon-sign-1.svg"},{id:2,name:"Taurus",imagePath:"img/moonSign/icon-sign-2.svg"},{id:3,name:"Gemini",imagePath:"img/moonSign/icon-sign-3.svg"},{id:4,name:"Cancer",imagePath:"img/moonSign/icon-sign-4.svg"},{id:5,name:"Leo",imagePath:"img/moonSign/icon-sign-5.svg"},{id:6,name:"Virgo",imagePath:"img/moonSign/icon-sign-6.svg"},{id:7,name:"Libra",imagePath:"img/moonSign/icon-sign-7.svg"},{id:8,name:"Scorpio",imagePath:"img/moonSign/icon-sign-8.svg"},{id:9,name:"Sagittarius",imagePath:"img/moonSign/icon-sign-9.svg"},{id:10,name:"Capricorn",imagePath:"img/moonSign/icon-sign-10.svg"},{id:11,name:"Aquarius",imagePath:"img/moonSign/icon-sign-11.svg"},{id:12,name:"Pisces",imagePath:"img/moonSign/icon-sign-12.svg"}],e.clickedSign=function(t){e.signId=angular.copy(t),e.showLoader(),o.fromTemplateUrl("views/singleHoroscopeModal.html",function(o){e.singleHoroscopeModal=o,e.singleHoroscopeModal.show()},{scope:e,animation:"slide-in-right"})},e.closeModal=function(){e.singleHoroscopeModal&&e.singleHoroscopeModal.isShown()&&e.singleHoroscopeModal.remove()},e.askQuestion=function(){e.closeModal(),t.go("app.askQuestion"),e.transitionAnimation("left",700)}}]),askmonkApp.controller("singleHoroscopeModalCtrl",["$scope","utility","$timeout",function(e,o,t){o.getHoroscope(e.signId).then(function(o){e.hideLoader(),e.detailHoroscope=o,t(function(){e.floatingBtnAction=!0},10)},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})}]),askmonkApp.controller("loginCtrl",["$scope","$state","utility","CONSTANT","$ionicScrollDelegate","$timeout","$rootScope","$stateParams","$ionicModal","$ionicSlideBoxDelegate","base64Encoding",function(e,o,t,n,a,i,s,r,l,u,c){
e.authenticated?"underObeservation"==localStorage.getItem("questionStatus")?(r.id=localStorage.getItem("questionId"),o.go("app.singlequestion",r),e.transitionAnimation("left",180)):(o.go("app.dashboard"),e.transitionAnimation("left",180)):(e.monkTab=!0,e.userForgetPasswordShow=!1,e.userResendValidatonShow=!1,e.monkForgetPasswordShow=!1,e.hideLoader(),e.showNextButton=!0,e.args={email:"",password:"",ttl:435456e6},e.argsSignup={name:"",email:"",password:""},e.conpassword={pass:""},e.argsMonk={email:"",password:"",ttl:435456e6},e.$on("$ionicView.loaded",function(){i(function(){for(var e=1;4>e;e++){var o=angular.element(document.getElementById("video"+e));o[0].load()}},500)}),e.slideHasChanged=function(o){var t=angular.element(document.getElementById("video"+o));o>0&&(t[0].currentTime=0,t[0].play()),3==o?e.showNextButton=!1:e.showNextButton=!0},e.changeToNextSlide=function(){u.next()},e.openTnC=function(){return window.open("http://askmonk.in/privacy.html","_system","location=yes"),!1},e.userLoginForm=function(){e.userForgetPasswordShow=!1,e.monkForgetPasswordShow=!1,e.userResendValidatonShow=!1,e.args.email="",e.argsMonk.email="",e.userLoginModal&&e.userLoginModal.isShown()&&e.userLoginModal.remove(),l.fromTemplateUrl("userLoginModal.html",function(o){e.userLoginModal=o,e.userLoginModal.show()},{scope:e,animation:"slide-in-up"})},e.monkLoginForm=function(){e.userForgetPasswordShow=!1,e.monkForgetPasswordShow=!1,e.userResendValidatonShow=!1,e.args.email="",e.argsMonk.email="",e.monkLoginModal&&e.monkLoginModal.isShown()&&e.monkLoginModal.remove(),l.fromTemplateUrl("monkLoginModal.html",function(o){e.monkLoginModal=o,e.monkLoginModal.show()},{scope:e,animation:"slide-in-up"})},e.signUpTab=function(){e.monkTab=!1,e.signUptab=!0,i(function(){a.$getByHandle("loginScroll").scrollTo(0,50,!0)},10)},e.loginTab=function(){e.monkTab=!0,e.signUptab=!1,e.userForgetPasswordShow=!1,e.userResendValidatonShow=!1,e.args.email=""},e.loginMonkTab=function(){e.monkForgetPasswordShow=!1,e.argsMonk.email=""},e.forgetUserPasswordTab=function(){e.userForgetPasswordShow=!0,e.userResendValidatonShow=!1,e.args.email=""},e.resendValidationTab=function(){e.userForgetPasswordShow=!0,e.userResendValidatonShow=!0,e.args.email=""},e.forgetMonkPasswordTab=function(){e.monkForgetPasswordShow=!0,e.argsMonk.email=""},e.userLogin=function(a){return a.userEmail.$viewValue&&a.userEmail.$valid?a.userPassword.$viewValue&&a.userPassword.$valid?(e.showLoader(),void t.login(e.args).then(function(t){e.setAuth(!0),localStorage.setItem("loginType","user"),n.loginType="user",o.go("app.profile"),e.hideLoader(),e.userLoginModal&&e.userLoginModal.isShown()&&e.userLoginModal.remove(),e.registerNotificaton(),e.transitionAnimation("left",1500)},function(o){e.hideLoader(),o?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),e.showMessage(o.error.message)})):void e.showMessage("Please enter the correct password"):void e.showMessage("Please enter the correct email address")},e.monkLogin=function(){e.showLoader(),n.isDevice&&cordova.plugins.Keyboard.close(),t.monkLogin(e.argsMonk).then(function(t){e.setAuth(!0),o.go("app.profile"),localStorage.setItem("loginType","monk"),n.loginType="monk",e.hideLoader(),e.monkLoginModal&&e.monkLoginModal.isShown()&&e.monkLoginModal.remove(),e.registerNotificaton(),e.transitionAnimation("left",1400)},function(o){e.hideLoader(),o?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},e.userSignUp=function(a){return a.email.$viewValue&&a.email.$valid?a.password.$viewValue&&a.password.$valid?""!=e.conpassword.pass&&e.argsSignup.password!=e.conpassword.pass?void e.showMessage("Sorry, the passwords do not match"):""==e.argsSignup.name||""==e.argsSignup.email||""==e.argsSignup.password?void e.showMessage("All fields are required"):a.$valid?(e.showLoader(),n.isDevice&&cordova.plugins.Keyboard.close(),t.register(e.argsSignup).then(function(a){n.isComingFromSignUp=!0,localStorage.setItem("name",a.name),localStorage.setItem("email",a.email),t.login({email:a.email,password:e.argsSignup.password}).then(function(t){s.token=localStorage.getItem("token"),localStorage.setItem("profileData",JSON.stringify(a)),e.setAuth(!0),localStorage.setItem("loginType","user"),n.loginType="user",o.go("app.editProfile"),e.hideLoader(),e.userLoginModal&&e.userLoginModal.isShown()&&e.userLoginModal.remove(),e.registerNotificaton(),e.transitionAnimation("left",500)},function(o){e.hideLoader(),o?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},function(o){e.hideLoader(),o&&422==o.error.status?e.showMessage("Email address is already register"):e.showMessage("Something went wrong. Please try again.")}),void 0):void e.showMessage("Please share the right details"):void e.showMessage("Minimum password limit 6."):void e.showMessage("Please enter the correct email address")},e.userForgetPassword=function(){e.showLoader(),t.forgetUserPassword(c.encode(e.args.email)).then(function(o){e.hideLoader(),e.userLoginForm(),e.showMessage("Mail sent")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.userResendValidation=function(){e.showLoader(),t.resendValidationUser(c.encode(e.args.email)).then(function(o){e.hideLoader(),e.userLoginForm(),e.showMessage("Mail sent")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.monkForgetPassword=function(){e.showLoader(),t.forgetMonkPassword(c.encode(e.argsMonk.email)).then(function(o){e.hideLoader(),e.monkLoginForm(),e.showMessage("Mail sent")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.closeModal=function(){e.userLoginModal&&e.userLoginModal.isShown()&&e.userLoginModal.remove(),e.monkLoginModal&&e.monkLoginModal.isShown()&&e.monkLoginModal.remove()},e.userGoogleLogin=function(){e.showLoader(),window.plugins.googleplus.login({iOSApiKey:"915609605128-idn9dp6hnes236v35ko5pjhfmk4m8ap3.apps.googleusercontent.com"},function(a){t.googleOauth(a).then(function(t){e.setAuth(!0),localStorage.setItem("loginType","user"),localStorage.setItem("token",t.id),localStorage.setItem("userId",t.userId),n.loginType="user",t.firstTimeLogin?(localStorage.setItem("name",a.givenName),localStorage.setItem("email",a.email),s.profileData=angular.copy(a),s.profileData.name=angular.copy(s.profileData.displayName),n.isComingFromSignUp=!0,o.go("app.editProfile")):o.go("app.profile"),e.userLoginModal&&e.userLoginModal.isShown()&&e.userLoginModal.remove(),e.registerNotificaton(),e.hideLoader(),e.transitionAnimation("left",900)},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log("error",o)})},function(o){e.hideLoader(),console.log(JSON.stringify(o),"error")})})}]),askmonkApp.filter("trusted",["$sce",function(e){return function(o){return e.trustAsResourceUrl(o)}}]),askmonkApp.controller("openQuestionCtrl",["$scope","utility","$state","$stateParams",function(e,o,t,n){e.noQuestionFound=!1,e.search={searchInput:""},e.showClear=!1,e.$on("$ionicView.enter",function(){e.showLoader()});var a=0;e.noMoreQuestion=!1,o.getQuestionOnStatus("asked",a).then(function(o){e.hideLoader(),console.log(o),o.length>0?e.groups=o:e.noQuestionFound=!0},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)}),e.doRefresh=function(){a=0,e.noMoreQuestion=!1,o.getQuestionOnStatus("asked",a).then(function(o){e.$broadcast("scroll.refreshComplete"),console.log(o),o.length>0?e.groups=o:e.noQuestionFound=!0},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.loadMoreQuestion=function(){a+=10,e.showLoader(),o.getQuestionOnStatus("asked",a).then(function(o){console.log(o,"asked"),e.hideLoader(),0==o.length&&a>9?(e.noMoreQuestion=!0,e.$broadcast("scroll.infiniteScrollComplete")):(angular.forEach(o,function(o,t){e.groups.push(o)}),e.$broadcast("scroll.infiniteScrollComplete"))},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.goToQuestion=function(o){n.id=o,t.go("app.singlequestion",n),e.transitionAnimation("left",700)},e.inputSearch=function(){e.search.searchInput?e.showClear=!0:e.showClear=!1},e.clearSearch=function(){e.showClear=!1,e.search.searchInput=""}}]),askmonkApp.controller("profileCtrl",["$scope","$state","utility","CONSTANT","$rootScope","$timeout","$ionicPopup",function(e,o,t,n,a,i,s){e.floatingBtnAction=!1,e.$on("$ionicView.enter",function(){e.floatingBtnAction=!0,e.showLoader(),n.isDevice&&cordova.plugins.Keyboard.close()}),e.loginType=n.loginType,localStorage.getItem("profile")?(a.profileData=JSON.parse(localStorage.getItem("profile")),e.profileInfo=angular.copy(a.profileData),"user"==e.loginType?e.profileImage="img/moonSign/"+e.profileInfo.moonSign+".png":e.profileImage="http://askmonk.in/mImages/"+e.profileInfo.email.split("@")[0].toLowerCase()+".jpg",i(function(){e.hideLoader()},200)):"user"==e.loginType?t.getUserProfile(localStorage.getItem("userId")).then(function(t){localStorage.setItem("email",t.email),localStorage.setItem("name",t.name),e.$emit("updateSideMenuName",t),a.profileData=t,t.dob&&t.birthPlace&&t.birthTime&&t.gender?(e.hideLoader(),localStorage.setItem("profile",JSON.stringify(t)),e.profileInfo=angular.copy(a.profileData),e.profileImage="img/moonSign/"+e.profileInfo.moonSign+".png"):(n.isComingFromSignUp=!0,o.go("app.editProfile"),e.transitionAnimation("left"))},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)}):t.getMonkProfile().then(function(i){localStorage.setItem("email",i.email),localStorage.setItem("name",i.name),e.$emit("updateSideMenuName",i),a.profileData=i,i.name&&i.phone&&i.education&&i.residence&&i.experience?(e.hideLoader(),localStorage.setItem("profile",JSON.stringify(i)),e.$emit("updateAvaliableStatus"),e.profileInfo=angular.copy(a.profileData),e.profileImage="http://askmonk.in/mImages/"+e.profileInfo.email.split("@")[0].toLowerCase()+".jpg",t.directQuestionsPending().then(function(o){o.length>0&&(e.directQuestionData=o,e.showDirectQuestionCountPopup()),console.log(o)},function(o){o&&422==o.error.statusCode?e.showMessage(i.error.message):e.showMessage("Something went wrong. Please try again.")})):(n.isComingFromSignUp=!0,o.go("app.editProfile"),e.transitionAnimation("left"))},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)}),"user"==e.loginType?(t.getUserCount().then(function(o){e.getUserCount=o},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)}),localStorage.timelineJson||t.getTimeLineJson().then(function(e){localStorage.setItem("timelineJson",JSON.stringify(e))},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})):t.getMonkCount().then(function(o){e.getMonkCount=o},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)}),e.showDirectQuestionCountPopup=function(){var t=s.show({cssClass:"ios",title:e.directQuestionData.length+" direct questions unanswered.",template:"Want to answer now?",scope:e,buttons:[{text:"Ok",type:"button-ios button-clear",onTap:function(e){return!0}},{text:"Cancel",type:"button-ios button-clear",onTap:function(e){return!1}}]});t.then(function(e){e?(console.log("You are sure"),o.go("app.directQuestion")):console.log("You are not sure")})},e.profileEdit=function(){o.go("app.editProfile"),e.transitionAnimation("left",1200)},e.askQuestion=function(){o.go("app.askQuestion"),e.transitionAnimation("left",900)}}]),askmonkApp.filter("getEducation",function(){return function(e){return console.log(e),"10"==e||"12"==e?e+"th":e}}),askmonkApp.controller("settingCtrl",["$scope","utility","$ionicHistory","$rootScope","$http","$state","$templateCache","$ionicModal","$ionicPopup","CONSTANT",function(e,o,t,n,a,i,s,r,l,u){e.loginType=u.loginType,e.aboutUs=function(){r.fromTemplateUrl("views/aboutUsModal.html",function(o){e.aboutUsModal=o,e.aboutUsModal.show()},{scope:e,animation:"slide-in-up"})},e.privacyPolicy=function(){r.fromTemplateUrl("views/privacyPolicyModal.html",function(o){e.privacyPolicyModal=o,e.privacyPolicyModal.show()},{scope:e,animation:"slide-in-up"})},e.openBlog=function(){return window.open("https://askmonkblog.wordpress.com","_system","location=yes"),!1},e.getPaymentInfo=function(){e.showLoader(),"user"==e.loginType?o.userPaymentInfo().then(function(o){e.hideLoader(),console.log(o),e.paymentReceipts=o,r.fromTemplateUrl("paymentInfoModal.html",function(o){e.paymentInfoModal=o,e.paymentInfoModal.show()},{scope:e,animation:"slide-in-up"})},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}):o.monkPaymentInfo().then(function(o){e.hideLoader(),console.log(o),e.paymentReceipts=o,r.fromTemplateUrl("paymentInfoModal.html",function(o){e.paymentInfoModal=o,e.paymentInfoModal.show()},{scope:e,animation:"slide-in-up"})},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},e.helpDesk=function(){window.plugins.socialsharing.shareViaEmail(null,null,["support@askmonk.in"],null,null,null,onSuccess=function(){e.showMessage("Please share your query")},onError=function(o){e.showMessage("Something went wrong. Please try again")})},e.shareWhatsapp=function(){e.showLoader(),window.plugins.socialsharing.shareViaWhatsApp("Askmonk.in ( Innovative way to know about astrological solutions to one's crisp questions in no time. Download askmonk now where predictions are just a question away )",null,null,function(){e.hideLoader(),console.log("share ok")},function(o){e.hideLoader(),e.showMessage("Whatsapp is not installed."),console.log(o,"error")})},e.changePassword=function(){r.fromTemplateUrl("views/changePasswordModal.html",function(o){e.changePasswordModal=o,e.changePasswordModal.show()},{scope:e,animation:"slide-in-up"})},e.resendValidation=function(){r.fromTemplateUrl("resendValidationModal.html",function(o){e.resendValidationModal=o,e.resendValidationModal.show()},{scope:e,animation:"slide-in-up"})},e.logOut=function(){var t=l.show({cssClass:"ios",title:"Do you want to logout of askmonk?",buttons:[{text:"Yes",type:"button-ios button-clear",onTap:function(e){return!0}},{text:"No",type:"button-ios button-clear",onTap:function(e){return!1}}]});t.then(function(t){if(t)if(console.log("You are sure"),"monk"==e.loginType){var n=JSON.parse(localStorage.profile);o.updateMonkAvailableStatus({id:n.id,email:n.email,isAvailable:!1}).then(function(o){e.logout()},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})}else e.logout();else console.log("You are not sure")})},e.logout=function(){e.showLoader(),o.logout().then(function(o){i.go("login"),e.setAuth(!1),t.clearCache(),t.clearHistory();var r=i.current.templateUrl;s.remove(r),n.profileData=null,localStorage.clear(),e.loginType=localStorage.getItem("loginType"),delete a.defaults.headers.common.Authorization,e.hideLoader(),e.transitionAnimation("left",900)},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},e.closeModal=function(){e.aboutUsModal&&e.aboutUsModal.isShown()&&e.aboutUsModal.remove(),e.privacyPolicyModal&&e.privacyPolicyModal.isShown()&&e.privacyPolicyModal.remove(),e.changePasswordModal&&e.changePasswordModal.isShown()&&e.changePasswordModal.remove(),e.resendValidationModal&&e.resendValidationModal.isShown()&&e.resendValidationModal.remove(),e.paymentInfoModal&&e.paymentInfoModal.isShown()&&e.paymentInfoModal.remove()}}]),askmonkApp.controller("changePasswordModalCtrl",["$scope","utility","CONSTANT","$ionicPopup",function(e,o,t,n){e.model={password:""},e.args={con_password:""},e.passwordChangePopup=function(o){var t=n.show({cssClass:"ios",title:"Do you want to change your password?",buttons:[{text:"Yes",type:"button-ios button-clear",onTap:function(e){return!0}},{text:"No",type:"button-ios button-clear",onTap:function(e){return!1}}]});t.then(function(t){t?(console.log("You are sure"),e.passwordChange(o)):console.log("You are not sure")})},e.passwordChange=function(n){e.model.password&&e.args.con_password||e.showMessage("All fields are required"),e.model.password!==e.args.con_password?e.showMessage("Passwords don't match"):(e.showLoader(),"user"==t.loginType?o.changeUserPassword(e.model).then(function(o){e.hideLoader(),console.log(o,"success"),e.closeModal(),e.showMessage("Password change successfully")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}):o.changeMonkPassword(e.model).then(function(o){e.hideLoader(),e.closeModal(),e.showMessage("Password change successfully")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}))}}]),askmonkApp.controller("resendValidationModalCtrl",["$scope","utility","base64Encoding",function(e,o,t){e.args={email:localStorage.email},e.resendValidationSendPopup=function(n){return""==n.email.$viewValue||n.$invalid?void e.showMessage("Please enter the correct email address"):(e.showLoader(),void o.resendValidationUser(t.encode(e.args.email)).then(function(o){e.hideLoader(),e.closeModal(),e.showMessage("Mail sent")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}))}}]),askmonkApp.controller("singleQuestionCtrl",["$scope","$state","utility","$timeout","$stateParams","CONSTANT","$ionicModal","$ionicPopup",function(e,o,t,n,a,i,s,r){e.authenticated||o.go("login"),e.floatingBtnAction=!1,e.$on("$ionicView.enter",function(){e.floatingBtnAction=!0,e.showLoader()}),"underObservation"==localStorage.getItem("questionStatus")&&(i.isComingFromSignUp=!0,e.$emit("writeAnswerActive")),e.loginType=i.loginType,e.ratingSubmitted=!1,e.ratingEdit=!1,e.askQuestion=function(){o.go("app.askQuestion"),e.transitionAnimation("left",500)},t.getSingleQuestions(a.id).then(function(t){if(console.log(t),e.hideLoader(),e.question=t,"underObservation"==e.question.status&&e.question.monkId!=localStorage.userId){var n=r.alert({cssClass:"ios",title:"This question is already taken. Please try another question",buttons:[{text:"Ok",type:"button-ios button-clear",onTap:function(e){return!0}}]});n.then(function(e){o.go("app.dashboard")})}},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}),e.viewPartnerDetails=function(){s.fromTemplateUrl("views/viewPartnerDetailModal.html",function(o){e.viewPartnerDetailModal=o,e.viewPartnerDetailModal.show()},{scope:e,animation:"slide-in-up"})},e.editQuestion=function(){s.fromTemplateUrl("views/editQuestionModal.html",function(o){e.editQuestionModal=o,e.editQuestionModal.show()},{scope:e,animation:"slide-in-right"})},e.ratingEditing=function(){e.ratingEdit=!0},e.rateQuestion=function(){console.log(e.question),t.ratingQuestion({userId:localStorage.getItem("userId"),email:e.question.email,id:e.question.id,status:e.question.status,rating:e.question.rating}).then(function(o){console.log("success",o),e.question=angular.copy(o),e.ratingSubmitted=!0,e.ratingEdit=!1},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},e.writtenAnswer=localStorage.getItem("answer"),e.openWriteModal=function(){s.fromTemplateUrl("views/writeAnswerModal.html",function(o){e.writeAnswerModal=o,e.writeAnswerModal.show()},{scope:e,animation:"slide-in-up",hardwareBackButtonClose:!0})},e.writtenSolution=localStorage.getItem("solution"),e.openWriteSolutionModal=function(){s.fromTemplateUrl("views/writeSolutionModal.html",function(o){e.writeSolutionModal=o,e.writeSolutionModal.show()},{scope:e,animation:"slide-in-up",hardwareBackButtonClose:!0})},e.userDetail=function(){s.fromTemplateUrl("views/userDetailModal.html",function(o){e.userDetailModal=o,e.userDetailModal.show()},{scope:e,animation:"slide-in-up"})},e.acceptQuestion=function(){e.showLoader(),t.acceptQuestionMonk({userId:e.question.userId,email:e.question.email,id:e.question.id,monkId:localStorage.getItem("userId"),monkEmail:localStorage.getItem("email"),status:"asked"}).then(function(o){i.isComingFromSignUp=!0,e.$emit("writeAnswerActive"),e.question=angular.copy(o),localStorage.setItem("questionStatus",e.question.status),localStorage.setItem("questionId",e.question.id),e.hideLoader(),n(function(){e.openWriteModal()},100),console.log(o,"success")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},e.askBeforeAccept=function(){var o=r.show({cssClass:"ios",title:"After accepting a question answering it is mandatory.",template:"Do u want to proceed ?",buttons:[{text:"Yes",type:"button-ios button-clear",onTap:function(e){return!0}},{text:"No",type:"button-ios button-clear",onTap:function(e){return!1}}]});o.then(function(o){o?e.acceptQuestion():console.log("You are not sure")})},e.closeAnswerPopup=function(){e.writtenAnswer=localStorage.getItem("answer"),e.writeAnswerModal&&e.writeAnswerModal.isShown()&&e.writeAnswerModal.remove()},e.closeSolutionPopup=function(){e.writtenSolution=localStorage.getItem("solution"),e.writeSolutionModal&&e.writeSolutionModal.isShown()&&e.writeSolutionModal.remove()},e.postAnswer=function(){if(""==localStorage.getItem("answer"))return void e.showMessage("Please write your answer");if(""==localStorage.getItem("solution"))return void e.showMessage("Please write your solution");e.question.answer=localStorage.getItem("answer"),e.question.solution=localStorage.getItem("solution");var o=r.show({cssClass:"ios",title:"Going further would send the answer to the user.",template:"Do u wish to continue ?",buttons:[{text:"Yes",type:"button-ios button-clear",onTap:function(e){return!0}},{text:"No",type:"button-ios button-clear",onTap:function(e){return!1}}]});o.then(function(o){if(o){if(e.question.answer.length<100)return void e.showMessage("Minimum character length is 100.");if(e.question.solution.length<25)return void e.showMessage("Minimum character length is 25.");e.showLoader(),console.log("You are sure"),t.submitAnswer(e.question).then(function(o){e.hideLoader(),i.isComingFromSignUp=!1,e.$emit("writeAnswerActive"),e.writtenAnswer="",localStorage.removeItem("answer"),e.writtenSolution="",localStorage.removeItem("solution"),localStorage.removeItem("questionStatus"),localStorage.removeItem("questionId"),e.question=angular.copy(o)},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})}else console.log("You are not sure")})},e.closeEditModal=function(o){e.question=angular.copy(o),e.hideLoader(),e.editQuestionModal&&e.editQuestionModal.isShown()&&e.editQuestionModal.remove()},e.closeModal=function(){e.userDetailModal&&e.userDetailModal.isShown()&&e.userDetailModal.remove(),e.writeAnswerModal&&e.writeAnswerModal.isShown()&&e.writeAnswerModal.remove(),e.viewPartnerDetailModal&&e.viewPartnerDetailModal.isShown()&&e.viewPartnerDetailModal.remove(),e.editQuestionModal&&e.editQuestionModal.isShown()&&e.editQuestionModal.remove()},e.goToWalletFromModal=function(){e.closeModal(),o.go("app.wallet")},e.showMonkPage=function(){o.go("app.yprofile",{id:e.question.monkId})}}]),askmonkApp.controller("writeAnswerModalPopupCtrl",["$scope","$timeout",function(e,o){e.writeAnswerTextarea={answer:""},localStorage.getItem("answer")&&(e.writeAnswerTextarea.answer=localStorage.getItem("answer")),e.closeWriteAnswerPopup=function(){o(function(){e.closeAnswerPopup()},250),cordova.plugins.Keyboard.close()},e.expandText=function(){localStorage.setItem("answer",e.writeAnswerTextarea.answer);var o=document.getElementById("writeAnswerTextarea");o.style.height=o.scrollHeight+"px"}}]),askmonkApp.controller("writeSolutionModalPopupCtrl",["$scope","$timeout",function(e,o){e.writeSolutionTextarea={solution:""},localStorage.getItem("solution")&&(e.writeSolutionTextarea.solution=localStorage.getItem("solution")),e.closeWriteSolutionPopup=function(){o(function(){e.closeSolutionPopup()},250),cordova.plugins.Keyboard.close()},e.expandText=function(){localStorage.setItem("solution",e.writeSolutionTextarea.solution);var o=document.getElementById("writeAnswerTextarea");o.style.height=o.scrollHeight+"px"}}]),askmonkApp.controller("userDetailModalPopupCtrl",["$scope","getMoonSign",function(e,o){e.profileInfo=angular.copy(o(e.question)),e.profileImage="img/moonSign/"+e.profileInfo.moonSign+".png"}]),askmonkApp.controller("viewPartnerDetailModalCtrl",["$scope","getMoonSign",function(e,o){e.partnerProfileInfo=angular.copy(o(e.question.matchMakingDetails)),e.partnerProfileImage="img/moonSign/"+e.partnerProfileInfo.moonSign+".png"}]),askmonkApp.controller("editQuestionModalCtrl",["$scope","utility","$timeout",function(e,o,t){function n(o){e.showDate=!0,o?e.datepickerObject.inputDate=o:e.datepickerObject.inputDate=new Date,e.editQuestion.matchMakingDetails.partnerDOB=angular.copy(e.datepickerObject.inputDate)}function a(o){if(angular.element(document.getElementsByClassName("ion-birth-time")).addClass("used"),"undefined"==typeof o)e.editQuestion.matchMakingDetails.partnerBirthTime=new Date;else{var t=new Date(1e3*o);e.editQuestion.matchMakingDetails.partnerBirthTime=new Date,e.editQuestion.matchMakingDetails.partnerBirthTime.setMinutes(t.getUTCMinutes()),e.editQuestion.matchMakingDetails.partnerBirthTime.setHours(t.getUTCHours())}}e.editQuestion=angular.copy(e.question),console.log(e.question),localStorage.tagQuestion?(e.questionTag=JSON.parse(localStorage.getItem("tagQuestion")),e.hideLoader()):o.getAllQuestion().then(function(o){e.hideLoader(),e.questionTag=o,localStorage.setItem("tagQuestion",JSON.stringify(o))},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)}),"Match Making"==e.editQuestion.questionTag&&(e.editQuestion.matchMakingDetails.partnerBirthTime=angular.copy(new Date(e.editQuestion.matchMakingDetails.partnerBirthTime)),e.editQuestion.matchMakingDetails.partnerDOB=angular.copy(new Date(e.editQuestion.matchMakingDetails.partnerDOB)),t(function(){e.editQuestion.matchMakingDetails.partnerBirthPlace&&angular.element(document.getElementsByClassName("ion-google-place")).addClass("used"),e.editQuestion.matchMakingDetails.partnerBirthTime&&angular.element(document.getElementsByClassName("ion-birth-time")).addClass("used")},50),e.datepickerObject={titleLabel:"DOB",todayLabel:"Today",closeLabel:"Close",setLabel:"Set",setButtonType:"button-askmonk",todayButtonType:"button-askmonk",closeButtonType:"button-askmonk",inputDate:e.editQuestion.matchMakingDetails.partnerDOB,mondayFirst:!0,templateType:"popup",showTodayButton:"false",modalHeaderColor:"bar-positive",modalFooterColor:"bar-positive",from:new Date(1940,1,1),to:new Date,callback:function(e){n(e)},dateFormat:"dd-MM-yyyy",closeOnSelect:!0},e.timePickerObject12Hour={inputEpochTime:e.editQuestion.matchMakingDetails.partnerBirthTime?60*new Date(e.editQuestion.matchMakingDetails.partnerBirthTime).getHours()*60+60*new Date(e.editQuestion.matchMakingDetails.partnerBirthTime).getMinutes():60*(new Date).getHours()*60,step:1,format:12,titleLabel:"Partner Birth Time",closeLabel:"Close",setLabel:"Set",setButtonType:"button-askmonk",closeButtonType:"button-askmonk",callback:function(e){a(e)}}),e.saveEditQuestion=function(){e.showLoader(),o.editQuestion(e.editQuestion).then(function(o){console.log(o,"success"),e.closeEditModal(o)},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o,"error")})}}]),askmonkApp.controller("walletCtrl",["$scope","utility","$state","CONSTANT","$timeout",function(e,o,t,n,a){function i(o){"native.keyboardshow"==o.type?a(function(){e.floatingBtnAction=!1},200):e.floatingBtnAction=!0}e.floatingBtnAction=!1,e.$on("$ionicView.enter",function(){e.floatingBtnAction=!0,e.showLoader()}),e.loginType=n.loginType,e.money={customMoney:"200"},window.addEventListener("native.keyboardshow",i),window.addEventListener("native.keyboardhide",i),e.askQuestion=function(){t.go("app.askQuestion"),e.transitionAnimation("left",500)},"user"==e.loginType?o.getUserCount().then(function(o){e.walletMoney=o.walletMoney,e.hideLoader()},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}):o.getMonkCount().then(function(o){e.walletMoney=o.walletMoney,e.totalWalletMoney=o.totalWalletMoney,e.hideLoader()},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}),e.options=function(o){e.amount=100*o.amount;var t=JSON.parse(localStorage.profile),n={description:o.name,currency:"INR",key:"rzp_test_2jGmoGfR3KHvoA",amount:e.amount,name:"Askmonk",prefill:{email:t.email,contact:t.mobile,name:t.name},theme:{color:"#00BCD2"}};return n};var s=function(t){t?(e.showLoader(),o.addMoney({userId:localStorage.getItem("userId"),email:localStorage.getItem("email"),amount:e.amount,payment_id:t}).then(function(o){e.hideLoader(),e.showMessage("Transaction successful"),e.walletMoney=o.walletMoney,localStorage.profile=JSON.stringify(o)},function(o){e.showMessage("Something went wrong. Try again")})):e.showMessage("Something went wrong. Try again")},r=function(o){e.showMessage(o.description)};e.getPayment=function(o){RazorpayCheckout.open(e.options(o),s,r)},e.addCustomMoney=function(o){o.$valid?e.money.customMoney>=100?e.getPayment({amount:e.money.customMoney,name:"Custom"}):e.showMessage("Minimum amount Rs.100"):e.showMessage("Please enter valid amount")},localStorage.getItem("packs")?e.packs=JSON.parse(localStorage.getItem("packs")):"user"==e.loginType&&o.getPacks().then(function(o){localStorage.setItem("packs",JSON.stringify(o)),e.packs=o},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})}]),askmonkApp.controller("yProfileCtrl",["$scope","$state","$stateParams","utility","$timeout","CONSTANT","$ionicPopup",function(e,o,t,n,a,i,s){t.id?(e.$on("$ionicView.enter",function(){e.showLoader()}),e.loginType=i.loginType,n.getSingleMonk(t.id).then(function(o){e.hideLoader(),e.monkProfileData=o},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}),e.askQuestion=function(){if(e.monkProfileData.isAvailable)localStorage.setItem("directQuestion",JSON.stringify({monkId:e.monkProfileData.id,monkName:e.monkProfileData.name,monkEmail:e.monkProfileData.email,isDirect:!0})),o.go("app.askQuestion"),e.transitionAnimation("left",500);else{var t=s.show({cssClass:"ios",title:"Monk is not available right now. Please try again after some time or post open question.",
buttons:[{text:"Ok",type:"button-ios button-clear",onTap:function(e){return!0}}]});t.then(function(e){e?console.log("You are sure"):console.log("You are not sure")})}}):(o.go("app.yprofiles"),e.transitionAnimation("left",500))}]),askmonkApp.controller("yProfilesCtrl",["$scope","$state","utility","$stateParams","CONSTANT","$timeout",function(e,o,t,n,a,i){e.$on("$ionicView.enter",function(){e.showLoader()}),e.loginType=a.loginType,e.showFilterMenu=!1,e.sortedFilterValue=!0,e.sortedFilter="rating",t.getAllMonks().then(function(o){localStorage.setItem("monksProfiles",JSON.stringify(o)),e.monksProfiles=o,e.hideLoader()},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o,"error")}),e.goToYogiProfile=function(t){n.id=t,o.go("app.yprofile",n),e.transitionAnimation("left",500)},e.askQuestion=function(){o.go("app.askQuestion"),e.transitionAnimation("left",180)},e.showFilter=function(){e.showFilterMenu=!0},e.closeFilterMenu=function(){e.showFilterMenu=!1},e.sortFilter=function(o){"name"==o?e.sortedFilterValue=e.sortedFilter===o?!e.sortedFilterValue:!1:e.sortedFilterValue=e.sortedFilter===o?!e.sortedFilterValue:!0,e.sortedFilter=o,e.showFilterMenu=!1}}]),askmonkApp.directive("focusMe",["$timeout","$ionicScrollDelegate",function(e,o){return{link:function(t,n,a){e(function(){n[0].focus(),e(function(){o.$getByHandle("scrollHandle").resize(),o.$getByHandle("scrollHandle").scrollBottom(!0)},200)},100)}}}]),askmonkApp.directive("writeAnswer",["$timeout",function(e){return{link:function(o,t,n){e(function(){t[0].focus()},420)}}}]),askmonkApp.filter("timeago",function(){return function(e,o,t){if(!e)return"never";if(o||(o=Date.now()),angular.isDate(e)?e=e.getTime():"string"==typeof e&&(e=new Date(e).getTime()),angular.isDate(o)?o=o.getTime():"string"==typeof o&&(o=new Date(o).getTime()),"number"==typeof e&&"number"==typeof o){var n=Math.abs((o-e)/1e3),a=[],i=60,s=3600,r=86400,l=604800,u=31556926,c=315569260;return a=i>=n?["",t?"now":"a minute"]:60*i>n?[Math.round(Math.abs(n/i)),"min"]:24*s>n?[Math.round(Math.abs(n/s)),"hr"]:7*r>n?[Math.round(Math.abs(n/r)),"day"]:52*l>n?[Math.round(Math.abs(n/l)),"week"]:10*u>n?[Math.round(Math.abs(n/u)),"year"]:100*c>n?[Math.round(Math.abs(n/c)),"decade"]:["","a long time"],a[1]+=0===a[0]||a[0]>1?"s":"",a=a.join(" "),t===!0?a:o>=e?a+" ago":"in "+a}}}),askmonkApp.directive("nxEqual",function(){return{require:"ngModel",link:function(e,o,t,n){return t.nxEqual?(e.$watch(t.nxEqual,function(e){n.$setValidity("nxEqual",e===n.$viewValue)}),void n.$parsers.push(function(o){var a=o===e.$eval(t.nxEqual);return n.$setValidity("nxEqual",a),a?o:void 0})):void console.error("nxEqual expects a model as an argument!")}}}),askmonkApp.directive("embedSrc",function(){return{restrict:"A",link:function(e,o,t){var n=o;e.$watch(function(){return t.embedSrc},function(){var e=o.clone().attr("src",t.embedSrc);n.replaceWith(e),n=e})}}}),askmonkApp.filter("ageFilter",function(){function e(e){if(e){e=new Date(e);var o=Date.now()-e.getTime(),t=new Date(o);return Math.abs(t.getUTCFullYear()-1970)}}return function(o){return e(o)}}),askmonkApp.factory("base64Encoding",function(){var e={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(o){var t,n,a,i,s,r,l,u="",c=0;for(o=e._utf8_encode(o);c<o.length;)t=o.charCodeAt(c++),n=o.charCodeAt(c++),a=o.charCodeAt(c++),i=t>>2,s=(3&t)<<4|n>>4,r=(15&n)<<2|a>>6,l=63&a,isNaN(n)?r=l=64:isNaN(a)&&(l=64),u=u+this._keyStr.charAt(i)+this._keyStr.charAt(s)+this._keyStr.charAt(r)+this._keyStr.charAt(l);return u},decode:function(o){var t,n,a,i,s,r,l,u="",c=0;for(o=o.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<o.length;)i=this._keyStr.indexOf(o.charAt(c++)),s=this._keyStr.indexOf(o.charAt(c++)),r=this._keyStr.indexOf(o.charAt(c++)),l=this._keyStr.indexOf(o.charAt(c++)),t=i<<2|s>>4,n=(15&s)<<4|r>>2,a=(3&r)<<6|l,u+=String.fromCharCode(t),64!=r&&(u+=String.fromCharCode(n)),64!=l&&(u+=String.fromCharCode(a));return u=e._utf8_decode(u)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var o="",t=0;t<e.length;t++){var n=e.charCodeAt(t);128>n?o+=String.fromCharCode(n):n>127&&2048>n?(o+=String.fromCharCode(n>>6|192),o+=String.fromCharCode(63&n|128)):(o+=String.fromCharCode(n>>12|224),o+=String.fromCharCode(n>>6&63|128),o+=String.fromCharCode(63&n|128))}return o},_utf8_decode:function(e){for(var o="",t=0,n=c1=c2=0;t<e.length;)n=e.charCodeAt(t),128>n?(o+=String.fromCharCode(n),t++):n>191&&224>n?(c2=e.charCodeAt(t+1),o+=String.fromCharCode((31&n)<<6|63&c2),t+=2):(c2=e.charCodeAt(t+1),c3=e.charCodeAt(t+2),o+=String.fromCharCode((15&n)<<12|(63&c2)<<6|63&c3),t+=3);return o}};return e}),askmonkApp.factory("getMoonSign",function(){return function(e){var o=["capricorn","aquarius","pisces","aries","taurus","gemini","cancer","leo","virgo","libra","scorpio","sagittarius"];if(e.dob)var t=new Date(e.dob);else if(e.partnerDOB)var t=new Date(e.partnerDOB);else if(e.userDOB)var t=new Date(e.userDOB);var n=t.getDate(),a=t.getMonth();switch(a){case 0:20>n?e.moonSign=o[0]:e.moonSign=o[1];break;case 1:19>n?e.moonSign=o[1]:e.moonSign=o[2];break;case 2:21>n?e.moonSign=o[2]:e.moonSign=o[3];break;case 3:20>n?e.moonSign=o[3]:e.moonSign=o[4];break;case 4:21>n?e.moonSign=o[4]:e.moonSign=o[5];break;case 5:21>n?e.moonSign=o[5]:e.moonSign=o[6];break;case 6:23>n?e.moonSign=o[6]:e.moonSign=o[7];break;case 7:23>n?e.moonSign=o[7]:e.moonSign=o[8];break;case 8:23>n?e.moonSign=o[8]:e.moonSign=o[9];break;case 9:23>n?e.moonSign=o[9]:e.moonSign=o[10];break;case 10:22>n?e.moonSign=o[10]:e.moonSign=o[11];break;case 11:22>n?e.moonSign=o[11]:e.moonSign=o[0]}return e}}),askmonkApp.service("utility",["$q","$http","$state",function e(o,t,n){var a={authenticated:null,request:function(e){localStorage.getItem("token")&&(t.defaults.headers.common.Authorization="Basic "+localStorage.getItem("token")),s=e.params||{},e=e||{};var n=o.defer(),a=this.API_URL+e.url,i=e.method||"GET",s=s,r=e.data||{};return t({url:a,withCredentials:this.use_session,method:i.toUpperCase(),params:s,data:r,timeout:9e4}).success(angular.bind(this,function(e,o,t,a){n.resolve(e,o)})).error(angular.bind(this,function(e,o,t,a){n.reject(e,o)})),n.promise},register:function(e){return this.request({method:"POST",url:"/api/users/",data:e})},login:function(o){return this.request({method:"POST",url:"/api/users/login/",data:o}).then(function(o){e.use_session||(t.defaults.headers.common.Authorization="Basic "+o.id,localStorage.setItem("token",o.id),localStorage.setItem("userId",o.userId))})},googleOauth:function(e){return this.request({method:"POST",url:"/googleOAuthLogin/",params:e})},logout:function(){return this.request({method:"POST",url:"/api/users/logout",params:{access_token:localStorage.getItem("token")}})},changeUserPassword:function(e){return this.request({method:"POST",url:"/api/users/changePassword/",data:e,params:{access_token:localStorage.getItem("token"),email:localStorage.getItem("email")}})},forgetUserPassword:function(e){return this.request({method:"POST",url:"/request-password-reset/user/"+e})},resendValidationUser:function(e){return this.request({method:"POST",url:"/resendValidationEmail/"+e})},getAllQuestion:function(){return this.request({method:"GET",url:"/api/questions/tagQuestions"})},getUserQuestions:function(){return this.request({method:"GET",url:"/api/questions/getQuestions/"+localStorage.getItem("userId")})},getSingleQuestions:function(e){return this.request({method:"GET",url:"/api/questions/"+e})},getUserProfile:function(e){return this.request({method:"GET",url:"/api/users/findUser/"+e})},updateUserProfile:function(e){return this.request({method:"PUT",url:"/api/users/"+localStorage.getItem("userId"),data:e,params:{access_token:localStorage.getItem("token")}})},askQuestion:function(e){return this.request({method:"POST",url:"/api/questions/askQuestion",data:e})},editQuestion:function(e){return this.request({method:"POST",url:"/api/questions/editQuestion",data:e})},askDirectQuestion:function(e){return this.request({method:"POST",url:"/api/questions/askDirect",data:e})},getPacks:function(){return this.request({method:"GET",url:"/api/payments/packs"})},getAllMonks:function(){return this.request({method:"GET",url:"/api/monks"})},getSingleMonk:function(e){return this.request({method:"GET",url:"/api/monks/getMonkDetails/"+e})},ratingQuestion:function(e){return this.request({method:"POST",url:"/api/users/rateAnswerByUser",data:e})},getUserCount:function(){return this.request({method:"GET",url:"/api/users/getCounts/"+localStorage.getItem("userId")})},getTimeLineJson:function(){return this.request({method:"GET",url:"/api/questions/timeLineJson"})},getHoroscope:function(e){return this.request({method:"GET",url:"/dailyHoroscope/"+e})},userPaymentInfo:function(){return this.request({method:"GET",url:"/api/payments/findPayments/"+localStorage.getItem("userId")})},notification:function(e){return this.request({method:"POST",url:"/api/notifications/registerDevice",data:e})},updateMonkAvailableStatus:function(e){return this.request({method:"POST",url:"/api/monks/availableStatus",data:e,params:{access_token:localStorage.getItem("token")}})},monkLogin:function(o){return this.request({method:"POST",url:"/api/monks/login/",data:o}).then(function(o){e.use_session||(t.defaults.headers.common.Authorization="Basic "+o.id,localStorage.setItem("token",o.id),localStorage.setItem("userId",o.userId))})},forgetMonkPassword:function(e){return this.request({method:"POST",url:"/request-password-reset/monk/"+e})},getMonkProfile:function(){return this.request({method:"GET",url:"/api/monks/findMonk/"+localStorage.getItem("userId")})},updateMonkProfile:function(e){return this.request({method:"PUT",url:"/api/monks/"+localStorage.getItem("userId"),data:e,params:{access_token:localStorage.getItem("token")}})},getQuestionOnStatus:function(e,o){return this.request({method:"GET",url:"/api/questions/getStatusQuestions/"+e+"/"+o})},getMonkAnsweredQuestion:function(e){return this.request({method:"GET",url:"/api/questions/findMonkQuestions/"+localStorage.getItem("userId")+"/"+e})},acceptQuestionMonk:function(e){return this.request({method:"POST",url:"/api/questions/acceptQuestion/",data:e})},submitAnswer:function(e){return this.request({method:"POST",url:"/api/monks/answerQuestion/",data:e,params:{access_token:localStorage.getItem("token")}})},getDirectQuestion:function(e){return this.request({method:"GET",url:"/api/questions/directQuestions/"+localStorage.getItem("userId")+"/"+e})},changeMonkPassword:function(e){return this.request({method:"POST",url:"/api/monks/changeMonkPassword/",data:e,params:{access_token:localStorage.getItem("token"),email:localStorage.getItem("email")}})},addMoney:function(e){return this.request({method:"POST",url:"/api/payments/addMoney/",data:e,params:{access_token:localStorage.getItem("token")}})},getMonkCount:function(){return this.request({method:"GET",url:"/api/monks/getCounts/"+localStorage.getItem("userId")})},directQuestionsPending:function(){return this.request({method:"GET",url:"/api/monks/directQuestionsPending/"+localStorage.getItem("userId")})},monkPaymentInfo:function(){return this.request({method:"GET",url:"/api/monkPayments/findPayments/"+localStorage.getItem("userId")})},initialize:function(o,t,n,a){this.API_URL=o,this.use_session=t,n&&(n.authenticated=null,null==this.authenticated?localStorage.getItem("token")?(e.authenticated=!0,n.authenticated=!0,a.token=localStorage.getItem("token")):(e.authenticated=!1,n.authenticated=!1):n.authenticated=this.authenticated,n.setAuth=function(e){n.authenticated=e})}};return a}]);