var askmonkApp=angular.module("askmonkApp",["ionic","ionMdInput","ionic-datepicker","ionic.rating","tabSlideBox","monospaced.elastic","ion-google-place","ionic-timepicker","ionic-native-transitions","ion-datetime-picker","templates"]);askmonkApp.run(["$ionicPlatform","$state","$stateParams","CONSTANT","$timeout",function(e,o,t,n,a){localStorage.getItem("token")?localStorage.profile&&"underObservation"==localStorage.getItem("questionStatus")?(t.id=localStorage.getItem("questionId"),o.go("app.singlequestion",t)):o.go("app.profile"):o.go("login"),e.ready(function(){window.MobileAccessibility&&window.MobileAccessibility.usePreferredTextZoom(!1),window.cordova&&window.cordova.plugins.Keyboard&&cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),window.StatusBar&&(window.StatusBar.overlaysWebView(!0),window.StatusBar.backgroundColorByHexString("#000")),a(function(){navigator&&navigator.splashscreen&&navigator.splashscreen.hide(),window.navigator&&window.navigator.splashscreen&&window.navigator.splashscreen.hide()},3e3),n.isDevice=ionic.Platform.device().available,void 0!==typeof analytics&&analytics.startTrackerWithId("UA-75134245-2")}),n.PRODUCTION_MODE&&(window.console&&window.console.log&&(window.console.log=function(){}),window.alert&&(window.alert=function(){}))}]),askmonkApp.config(["$stateProvider","$urlRouterProvider","$ionicConfigProvider","$ionicNativeTransitionsProvider","$logProvider",function(e,o,t,n,a){t.views.transition("none"),t.views.swipeBackEnabled(!1),a.debugEnabled(!1),n.setDefaultOptions({duration:190,androiddelay:-1,fixedPixelsTop:0,fixedPixelsBottom:0,triggerTransitionEvent:"$ionicView.afterEnter",backInOppositeDirection:!0}),n.setDefaultBackTransition({type:"fade",duration:600}),e.state("login",{url:"/login",templateUrl:"views/login.html",controller:"loginCtrl"}).state("app",{url:"/app","abstract":!0,cache:!1,templateUrl:"views/sidemenu.html",controller:"appCtrl"}).state("app.profile",{url:"/profile",nativeTransitions:null,cache:!1,views:{menuContent:{templateUrl:"views/profile.html",controller:"profileCtrl"}}}).state("app.yprofiles",{url:"/yogi-profiles",nativeTransitions:null,cache:!1,views:{menuContent:{templateUrl:"views/yogi-profiles-tile.html",controller:"yProfilesCtrl"}}}).state("app.yprofile",{url:"/yogi-profile/{id}",cache:!1,views:{menuContent:{templateUrl:"views/yogi-profile.html",controller:"yProfileCtrl"}}}).state("app.directQuestion",{url:"/direct-question",nativeTransitions:null,cache:!1,views:{menuContent:{templateUrl:"views/directQuestion.html",controller:"directQuestionCtrl"}}}).state("app.openQuestion",{url:"/open-question",nativeTransitions:null,cache:!1,views:{menuContent:{templateUrl:"views/openQuestion.html",controller:"openQuestionCtrl"}}}).state("app.draftQuestion",{url:"/draft-question",nativeTransitions:null,cache:!1,views:{menuContent:{templateUrl:"views/draftQuestion.html",controller:"draftQuestionCtrl"}}}).state("app.wallet",{url:"/wallet",nativeTransitions:null,cache:!1,views:{menuContent:{templateUrl:"views/wallet.html",controller:"walletCtrl"}}}).state("app.setting",{url:"/setting",nativeTransitions:null,views:{menuContent:{templateUrl:"views/setting.html",controller:"settingCtrl"}}}).state("app.editProfile",{url:"/editprofile",cache:!1,views:{menuContent:{templateUrl:"views/editProfile.html",controller:"editProfileCtrl"}}}).state("app.askQuestion",{url:"/askquestion",cache:!1,views:{menuContent:{templateUrl:"views/askQuestion.html",controller:"askQuestionCtrl"}}}).state("app.dashboard",{url:"/dashboard",nativeTransitions:null,cache:!1,views:{menuContent:{templateUrl:"views/dashboard.html",controller:"dashboardCtrl"}}}).state("app.singlequestion",{url:"/singlequestion/{id}",cache:!1,views:{menuContent:{templateUrl:"views/singleQuestion.html",controller:"singleQuestionCtrl"}}}).state("app.broadcastquestion",{url:"/broadcastquestion/{id}",cache:!1,views:{menuContent:{templateUrl:"views/broadcastQuestion.html",controller:"broadcastQuestionCtrl"}}}).state("app.horoscope",{url:"/dailyHoroscope",nativeTransitions:null,views:{menuContent:{templateUrl:"views/allHoroscope.html",controller:"horoscopeCtrl"}}}).state("app.packages",{url:"/fullPackages",nativeTransitions:null,cache:!1,views:{menuContent:{templateUrl:"views/fullPackages.html",controller:"fullPackagesCtrl"}}})}]),askmonkApp.constant("CONSTANT",{baseUrl:"http://askmonk.in:3000",isComingFromSignUp:!1,isDevice:!1,loginType:null,pushSenderID:"915609605128",razorPayKey:"rzp_test_Gyvc5rLmpetSzJ",razorPayImage:"https://i.imgur.com/BaLhC5I.png",PRODUCTION_MODE:!0}),askmonkApp.controller("askQuestionCtrl",["$scope","$state","utility","$ionicScrollDelegate","$timeout","CONSTANT","$ionicPopup","$ionicModal",function(e,o,t,n,a,s,i,r){function l(e){a(function(){n.$getByHandle("scrollHandle").resize(),n.$getByHandle("scrollHandle").scrollBottom(!0)},150)}function u(o){e.showDate=!0,o?e.datepickerObject.inputDate=o:e.datepickerObject.inputDate=new Date,e.args.partnerDOB=angular.copy(e.datepickerObject.inputDate)}var c;window.addEventListener("native.keyboardshow",l),window.addEventListener("native.keyboardhide",l),a(function(){analytics.trackView("Ask Question Page")},1500),e.args={partnerName:"",partnerBirthPlace:"",partnerBirthTime:"",partnerDOB:"",partnerGender:""},e.showQuestion=!0,e.askQuestion={email:localStorage.getItem("email"),userId:localStorage.getItem("userId"),question:"",questionTag:"",isDirect:!1,moneyType:""},e.askOtherQuestion={question:null},e.showOnOtherQuestion=!1,e.datepickerObject={titleLabel:"DOB",todayLabel:"Today",closeLabel:"Close",setLabel:"Set",setButtonType:"button-askmonk",todayButtonType:"button-askmonk",closeButtonType:"button-askmonk",inputDate:e.args.partnerDOB?new Date(e.args.partnerDOB):new Date,mondayFirst:!0,templateType:"popup",showTodayButton:"false",modalHeaderColor:"bar-positive",modalFooterColor:"bar-positive",from:new Date(1940,1,1),to:new Date,callback:function(e){u(e)},dateFormat:"dd-MM-yyyy",closeOnSelect:!0},e.timePickerObject12Hour={inputEpochTime:e.args.partnerBirthTime?60*new Date(e.args.partnerBirthTime).getHours()*60+60*new Date(e.args.partnerBirthTime).getMinutes():60*(new Date).getHours()*60,step:1,format:12,titleLabel:"Partner Birth Time",closeLabel:"Close",setLabel:"Set",setButtonType:"button-askmonk",closeButtonType:"button-askmonk",callback:function(e){timePicker12Callback(e)}},e.timePicker12Callback=function(e){angular.element(document.getElementsByClassName("ion-birth-time")).addClass("used")},"user"==e.loginType&&(e.showLoader(),t.getUserCount().then(function(o){e.hideLoader(),console.log(o),e.getUserCount=o},function(o){422==o.error.statusCode&&e.showMessage(o.error.message),e.hideLoader(),console.log(o)}),localStorage.timelineJson?e.timeLineJson=JSON.parse(localStorage.timelineJson):t.getTimeLineJson().then(function(o){e.timeLineJson=o,localStorage.setItem("timelineJson",JSON.stringify(o))},function(o){422==o.error.statusCode&&e.showMessage(o.error.message),console.log(o)})),localStorage.tagQuestion?e.questions=JSON.parse(localStorage.getItem("tagQuestion")):(e.showLoader(),t.getAllQuestion().then(function(o){e.questions=o,localStorage.setItem("tagQuestion",JSON.stringify(o))},function(o){422==o.error.statusCode&&e.showMessage(o.error.message),e.hideLoader(),console.log(o)})),e.selectedTimeline={value:"basic"},e.timeLineValueSelected="6",e.selectTimelineOption=function(){0==e.getUserCount.totalQuestionsAsked&&!e.getUserCount.makeFirstQuestionHalfRate&&e.getUserCount.makeFirstQuestionFree?e.showMessage("Free question has fixed duration of 6 months"):e.timeLinePopup=i.show({cssClass:"timelineSelector",title:"Duration : Rate Card",templateUrl:"selectTimelinePopup.html",scope:e})},e.askQuestionCategory=function(o,t){e.askQuestion.question="",e.showOnOtherQuestion=!1,"other"!=t?(e.askOtherQuestion.question=null,e.showQuestion=!0,e.preffredQuestion=angular.copy(e.questions[t]),a(function(){n.$getByHandle("scrollHandle").resize()},250)):(e.showQuestion=!1,a(function(){cordova.plugins.Keyboard.show()},200))},e.clearQuestionOnOther=function(){e.askQuestion.question==e.preffredQuestion[e.preffredQuestion.length-1]?(e.askOtherQuestion.question=null,e.showOnOtherQuestion=!0):(e.askOtherQuestion.question=null,e.showOnOtherQuestion=!1,a(function(){n.$getByHandle("scrollHandle").resize()},250),angular.element(c).css("margin-bottom","0px"))},e.addPartnerDetailsModal=function(){r.fromTemplateUrl("views/partnerDetailsModal.html",function(o){e.partnerDetailsModal=o,e.partnerDetailsModal.show()},{scope:e,animation:"slide-in-up",hardwareBackButtonClose:!0})},e.startPostingQuestion=function(o,n,a){e.amount=1;var s={userId:localStorage.userId,email:localStorage.email,amount:e.amount,paymentId:o,transactionId:n,paymentType:a};t.addMoney(s).then(function(o){localStorage.profile=JSON.stringify(o),e.askQuestionButton(),e.showMessage("Transaction successful")},function(o){e.hideLoader(),alert(JSON.stringify(o)),o?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},e.askQuestionButton=function(){localStorage.getItem("directQuestion")?t.askDirectQuestion(e.askQuestion).then(function(n){t.getUserCount().then(function(t){var n=JSON.parse(localStorage.profile);n.totalQuestionsAsked=t.totalQuestionsAsked,n.walletMoney=t.walletMoney,localStorage.profile=JSON.stringify(n),localStorage.setItem("updateDashboard",!0),e.hideLoader(),e.closeModal(),o.go("app.dashboard"),e.showMessage("Your question has been posted successfully")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}):t.askQuestion(e.askQuestion).then(function(n){t.getUserCount().then(function(t){var n=JSON.parse(localStorage.profile);n.totalQuestionsAsked=t.totalQuestionsAsked,n.walletMoney=t.walletMoney,localStorage.setItem("updateDashboard",!0),localStorage.profile=JSON.stringify(n),e.hideLoader(),e.closeModal(),o.go("app.dashboard")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},e.goTopaymentModal=function(){if(!e.getUserCount.emailVerified)return void e.showMessage("Please verify your email");if(e.askOtherQuestion.question){if(e.askOtherQuestion.question.length<10)return void e.showMessage("Minimum character length is 10.");e.askQuestion.question=null,e.askQuestion.question=angular.copy(e.askOtherQuestion.question),e.hideLoader()}if(localStorage.getItem("directQuestion")&&angular.extend(e.askQuestion,JSON.parse(localStorage.getItem("directQuestion"))),"Match Making"==e.askQuestion.questionTag){if(!(e.args.partnerName&&e.args.partnerBirthPlace&&e.args.partnerBirthTime&&e.args.partnerDOB&&e.args.partnerGender))return e.hideLoader(),e.addPartnerDetailsModal(),void e.showMessage("Partner details are required");e.askQuestion.matchMakingDetails=angular.copy(e.args)}e.askQuestion.question?(e.askQuestion.moneyType=angular.copy(e.selectedTimeline.value),r.fromTemplateUrl("views/paymentDetailsModal.html",function(o){e.paymentDetailsModal=o,e.paymentDetailsModal.show()},{scope:e,animation:"slide-in-right",hardwareBackButtonClose:!0})):(e.hideLoader(),e.showMessage("Please ask the desired question"))},e.cancelAskQuestion=function(){o.go("app.dashboard")},e.closeModal=function(){e.partnerDetailsModal&&e.partnerDetailsModal.isShown()&&e.partnerDetailsModal.remove(),e.paymentDetailsModal&&e.paymentDetailsModal.isShown()&&e.paymentDetailsModal.remove()},e.changePopValue=function(){e.timeLineValueSelected=angular.copy(e.timeLineJson[e.selectedTimeline.value].durationMonths),a(function(){e.timeLinePopup.close()},100)}}]),askmonkApp.controller("paymentDetailsModalCtrl",["$scope","base64Encoding","CONSTANT",function(e,o,t){e.paymentAskQuestion=angular.copy(e.askQuestion);var n=e.timeLineJson[e.paymentAskQuestion.moneyType];e.freeQuestion=e.getUserCount.makeFirstQuestionFree&&!e.getUserCount.makeFirstQuestionHalfRate&&0==e.getUserCount.totalQuestionsAsked?!0:!1,e.halfRateQuestion=e.getUserCount.makeFirstQuestionHalfRate&&!e.getUserCount.makeFirstQuestionFree&&0==e.getUserCount.totalQuestionsAsked?!0:!1,e.totalAmount=n.amount,e.freeQuestion&&(e.totalAmount=0),e.halfRateQuestion&&(e.totalAmount=n.amount/2),e.serviceTax=.15*e.totalAmount,e.basicCost=e.totalAmount-e.serviceTax,e.payWithPayU=function(){e.showLoader();var o,t=window.open("https://www.payumoney.com/paybypayumoney/#/121195","_blank","location=no");t.addEventListener("loadstart",function(n){if(n.url.indexOf("payumoney")>-1)if(n.url.indexOf("payment/notification/success")>-1){o=n.url.split("/")[n.url.split("/").length-1];var a="payUMoney",s="121195-"+o;t.close(),e.startPostingQuestion(o,s,a)}else n.url.indexOf("error")>-1&&t.close()}),t.addEventListener("exit",function(t){"undefined"!=typeof o&&o||(e.hideLoader(),e.showMessage("Transaction Cancelled"))})};var a=function(o){console.log(o);var t="paytm",n=o.ORDERID,a=o.TXNID;e.startPostingQuestion(a,n,t)},s=function(o){e.hideLoader(),console.log(o)};e.payWithPayTm=function(){e.showLoader();var t=o.encode("ASKMONK|"+Date.now()),n=localStorage.userId,i=localStorage.email,r=JSON.parse(localStorage.profile).mobile,l=e.totalAmount;window.plugins.paytm.startPayment(t,n,i,r,l,a,s)},e.postFreeQuestion=function(){e.showLoader(),e.askQuestionButton()}}]),askmonkApp.filter("timeLineFiter",function(){return function(e){return 6==e?"1/2 Year":1==parseInt(e/12)?parseInt(e/12)+"  Year":parseInt(e/12)+"  Years"}}),askmonkApp.controller("partnerDetailsModal",["$scope","$timeout",function(e,o){o(function(){e.args.partnerBirthPlace&&angular.element(document.getElementsByClassName("ion-google-place")).addClass("used"),e.args.partnerBirthTime&&angular.element(document.getElementsByClassName("ion-birth-time")).addClass("used")},50)}]),askmonkApp.controller("appCtrl",["$scope","CONSTANT","$state","utility","$rootScope","$timeout","$ionicPopup",function(e,o,t,n,a,s,i){e.isComingFromSignUp=o.isComingFromSignUp,e.loginType=o.loginType,e.$on("updateEditProfileFirstUser",function(){e.isComingFromSignUp=o.isComingFromSignUp,o.isComingFromSignUp&&e.showMessage("Please fill details to move further")}),e.$on("writeAnswerActive",function(){e.isComingFromSignUp=o.isComingFromSignUp,o.isComingFromSignUp&&e.showMessage("Write your answer")}),e.sideMenuName=localStorage.getItem("name"),localStorage.profile&&JSON.parse(localStorage.profile).profilePic?e.profilePic=JSON.parse(localStorage.profile).profilePic:e.profilePic="img/sidemenu_bg.jpg",e.$on("updateSideMenuName",function(t,n){e.loginType=o.loginType,e.sideMenuName=localStorage.getItem("name"),n.profilePic?e.profilePic=n.profilePic:e.profilePic="img/sidemenu_bg.jpg"}),e.goToAstrologers=function(){t.go("app.yprofiles")},"monk"==o.loginType&&(e.isAvailable={},localStorage.profile&&(e.isAvailable.status=JSON.parse(localStorage.profile).isAvailable,e.profileInfo=JSON.parse(localStorage.profile),e.profileImage="http://askmonk.in/mImages/"+e.profileInfo.email.split("@")[0].toLowerCase()+".jpg")),e.$on("updateAvaliableStatus",function(){e.isAvailable={},e.isAvailable.status=JSON.parse(localStorage.profile).isAvailable,e.profileInfo=JSON.parse(localStorage.profile),e.profileImage="http://askmonk.in/mImages/"+e.profileInfo.email.split("@")[0].toLowerCase()+".jpg"}),e.getDirectQuestionCount=function(){n.getDirectQuestionCount().then(function(o){o.count>0&&e.showDirectQuestionCountPopup(o)},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},e.showDirectQuestionCountPopup=function(o){var n=i.show({cssClass:"ios",title:o.count+" direct questions unanswered.",template:"Want to answer now?",scope:e,buttons:[{text:"Ok",type:"button-ios button-clear",onTap:function(e){return!0}},{text:"Cancel",type:"button-ios button-clear",onTap:function(e){return!1}}]});n.then(function(e){e?(console.log("You are sure"),t.go("app.directQuestion")):console.log("You are not sure")})},e.changeAvaliableStatus=function(){e.profileData=JSON.parse(localStorage.profile),e.isAvailable.status&&e.getDirectQuestionCount(),n.updateMonkAvailableStatus({id:e.profileData.id,email:e.profileData.email,isAvailable:e.isAvailable.status}).then(function(e){localStorage.profile=JSON.stringify(e),a.profileData=angular.copy(e)},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o,"error")})}}]),askmonkApp.controller("bodyCtrl",["$scope","utility","CONSTANT","$rootScope","CONSTANT","$ionicLoading","$timeout","$ionicHistory","$state","$ionicSideMenuDelegate","$ionicPlatform","$stateParams","HardwareBackButtonManager","$ionicNativeTransitions",function(e,o,t,n,t,a,s,i,r,l,u,c,g,d){function m(){e.authenticated&&e.registerNotificaton(),console.log("deviceReady"),document.addEventListener("online",h,!1),document.addEventListener("offline",p,!1),s(function(){console.log(sessionStorage.redirectFromUrl,"session"),5==sessionStorage.redirectFromUrl.split("askmonk://")[1]?s(function(){e.showMessage("Email validated. Happy askmonking")}):r.go("app.singlequestion",{id:sessionStorage.redirectFromUrl.split("askmonk://")[1]})},300),window.screen&&window.screen.lockOrientation&&window.screen.lockOrientation("portrait")}function p(){e.showMessage("Internet Connectivity error please try again")}function h(){console.log("online")}document.addEventListener("deviceready",m,!1),e.showArrow=!1,e.showMessage=function(e){window.plugins.toast.showWithOptions({message:e,duration:"long",position:"bottom",addPixelsY:-20},function(){console.log("sucess")},function(){console.log("error")})},e.registerNotificaton=function(){"android"===device.platform.toLowerCase()&&window.plugins.pushNotification.register(function(){},function(){alert("Push Notification registration FAIL on Android")},{ecb:"window.onNotificationGCM",senderID:t.pushSenderID})},window.onNotificationGCM=function(o){"message"==o.event?(console.log(o,e.authenticated),o.payload.questionId&&e.authenticated&&(12==o.payload.questionId?r.go("app.horoscope"):1==o.payload.questionId?r.go("app.askQuestion"):50==o.payload.questionId?r.go("app.profile"):"Article"==o.payload.notificationType?r.go("app.broadcastquestion",{id:o.payload.questionId}):"Question"==o.payload.notificationType?r.go("app.singlequestion",{id:o.payload.questionId}):r.go("app.profile"))):"registered"===o.event?window.registrationHandler(o.regid):"error"===o.event&&console.log("error",o)},window.registrationHandler=function(t){e.deviceInfo={deviceType:window.device.platform,userId:localStorage.userId,deviceId:t},o.notification(e.deviceInfo).then(function(e){console.log("success",JSON.stringify(e))},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},u.onHardwareBackButton(function(){var e=i.viewHistory().backView.stateName,o=i.viewHistory().currentView.stateName;"app.editProfile"!=o&&"app.profile"!=o||"login"!=e?"login"==o&&"app.setting"==e?ionic.Platform.exitApp():"login"==o&&"app.profile"==e&&ionic.Platform.exitApp():ionic.Platform.exitApp()},150),o.initialize(t.baseUrl,!1,e,n),e.showLoader=function(e){a.show({animation:"fade-in",showBackdrop:!1,template:'<ion-spinner icon="android" class="spinner-askmonk"></ion-spinner>'})},e.hideLoader=function(){function e(e){}function o(e){}a.hide(),t.isDevice&&window.cache.clear(e,o)},e.transitionAnimation=function(e,o){console.log(e,o)},e.hamburgerBtnEvent=function(){"app.editProfile"==r.current.name||"app.askQuestion"==r.current.name||"app.yprofile"==r.current.name||"app.singlequestion"==r.current.name||"app.broadcastquestion"==r.current.name?("undefined"!=typeof cordova&&cordova.plugins.Keyboard.isVisible&&cordova.plugins.Keyboard.close(),s(function(){d.locationUrl(i.viewHistory().backView.url,{type:"fade",duration:450})},10)):l.toggleLeft()},e.$on("$stateChangeStart",function(o,t,n,a,s){"app.yprofile"!=a.name&&"app.askQuestion"!=t.name&&localStorage.removeItem("directQuestion"),"app.editProfile"==t.name||"app.askQuestion"==t.name||"app.yprofile"==t.name||"app.singlequestion"==t.name||"app.broadcastquestion"==t.name?e.showArrow=!0:e.showArrow=!1}),t.loginType=localStorage.getItem("loginType")}]),askmonkApp.controller("broadcastQuestionCtrl",["$scope","$state","utility","$stateParams","CONSTANT","$timeout",function(e,o,t,n,a,s){e.authenticated||o.go("login"),e.$on("$ionicView.enter",function(){}),e.loginType=a.loginType,e.showLoader(),t.getSingleBroadcastArticle(n.id).then(function(o){console.log(o),e.hideLoader(),e.question=o},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}),e.shareArticle=function(){e.showLoader(),window.plugins.socialsharing.share(e.question.articleLink),s(function(){e.hideLoader()},2e3)}}]),askmonkApp.controller("dashboardCtrl",["$scope","$state","utility","$timeout","$stateParams","CONSTANT","$ionicSlideBoxDelegate","$ionicGesture","$ionicScrollDelegate",function(e,o,t,n,a,s,i,r,l){function u(o){"native.keyboardshow"==o.type?(e.floatingBtnAction=!1,e.floatingBtnLabel=!1):e.floatingBtnAction=!0}"underObservation"==localStorage.questionStatus&&(e.showArrow=!0,o.go("app.singlequestion",{id:localStorage.questionId})),localStorage.profile||o.go("app.profile"),e.noQuestionFound=!1,e.search={searchInput:""},e.question={askedQuestion:[],answeredQuestion:[],ratedQuestion:[]},e.floatingBtnAction=!1,e.floatingBtnLabel=!1,e.$on("$ionicView.beforeEnter",function(){}),e.$on("$ionicView.enter",function(){e.floatingBtnAction=!0,n(function(){e.floatingBtnLabel=!0},630)}),window.addEventListener("native.keyboardshow",u),window.addEventListener("native.keyboardhide",u),e.loginType=s.loginType,e.showClear=!1,e.noMoreAskedQuestion=!1,e.noMoreOtherQuestion=!1,e.showInfinteScroll=!1;var c=0,g=0;n(function(){i.$getByHandle("sliderScroll").enableSlide(!1),r.on("swiperight",function(e){1==i.$getByHandle("sliderScroll").currentIndex()?(i.$getByHandle("sliderScroll").previous(),l.$getByHandle("slide1Scroll").scrollTop(!0)):2==i.$getByHandle("sliderScroll").currentIndex()&&(i.$getByHandle("sliderScroll").previous(),l.$getByHandle("slide2Scroll").scrollTop(!0))},angular.element(document.querySelector("#sliderScroll"))),r.on("swipeleft",function(e){0==i.$getByHandle("sliderScroll").currentIndex()?(i.$getByHandle("sliderScroll").next(),l.$getByHandle("slide2Scroll").scrollTop(!0)):1==i.$getByHandle("sliderScroll").currentIndex()&&(i.$getByHandle("sliderScroll").next(),l.$getByHandle("slide3Scroll").scrollTop(!0))},angular.element(document.querySelector("#sliderScroll")))},500),e.questionSorted=function(o){e.question={askedQuestion:[],answeredQuestion:[],ratedQuestion:[]},angular.forEach(o,function(o,t){"asked"==o.status||"direct"==o.status||"fullAnalysis"==o.status?e.question.askedQuestion.push(o):"answered"==o.status?e.question.answeredQuestion.push(o):e.question.ratedQuestion.push(o)})},e.questionSortedMonk=function(o,t,n){"pullToRefresh"==n&&("asked"==t?e.question.askedQuestion=[]:"answered"==t?(e.question.answeredQuestion=[],e.question.ratedQuestion=[]):e.question={askedQuestion:[],answeredQuestion:[],ratedQuestion:[]}),angular.forEach(o,function(o,t){"asked"==o.status?e.question.askedQuestion.push(o):"answered"==o.status?e.question.answeredQuestion.push(o):e.question.ratedQuestion.push(o)})},e.askQuestion=function(){o.go("app.askQuestion")},e.getAllUserQuestion=function(o){sessionStorage.userQuestion&&!o?(e.questionSorted(JSON.parse(sessionStorage.userQuestion)),t.getUserCount().then(function(o){e.hideLoader(),e.getUserCount=o},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})):(e.showLoader(),t.getUserQuestions().then(function(o){n(function(){e.hideLoader()}),o.length>0&&(sessionStorage.setItem("userQuestion",JSON.stringify(o)),e.questionSorted(o)),t.getUserCount().then(function(o){e.getUserCount=o},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}))},"user"==e.loginType?e.getAllUserQuestion():(e.showLoader(),t.getMonkAnsweredQuestion(g).then(function(o){n(function(){e.hideLoader()}),e.questionSortedMonk(o,null,null),n(function(){e.showInfinteScroll=!0},1e3)},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})),localStorage.updateDashboard&&(localStorage.removeItem("updateDashboard"),e.getAllUserQuestion("updateDashboard")),e.loadMoreAskedQuestion=function(){c+=10,e.showLoader(),t.getQuestionOnStatus("asked",c).then(function(o){console.log(o,"asked"),e.hideLoader(),0==o.length&&c>9?(e.noQuestionFound=!0,e.noMoreAskedQuestion=!0,e.$broadcast("scroll.infiniteScrollComplete")):(e.questionSortedMonk(o,null,null),e.$broadcast("scroll.infiniteScrollComplete"))},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},e.loadMoreOtherQuestion=function(){g+=10,e.showLoader(),t.getMonkAnsweredQuestion(g).then(function(o){e.hideLoader(),console.log(o,"answered"),0==o.length&&g>9?(e.noMoreOtherQuestion=!0,e.$broadcast("scroll.infiniteScrollComplete")):(e.questionSortedMonk(o,null,null),e.$broadcast("scroll.infiniteScrollComplete"))},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.doRefresh=function(){c=0,e.noMoreAskedQuestion=!1,"user"==e.loginType?t.getUserQuestions().then(function(o){console.log(o),e.$broadcast("scroll.refreshComplete"),o.length>0?(sessionStorage.setItem("userQuestion",JSON.stringify(o)),e.questionSorted(o)):e.noQuestionFound=!0},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)}):t.getQuestionOnStatus("asked",c).then(function(o){e.$broadcast("scroll.refreshComplete"),o.length>0?e.questionSortedMonk(o,"asked","pullToRefresh"):e.noQuestionFound=!0},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.doRefreshOnAnsweredTab=function(){g=0,e.noMoreOtherQuestion=!1,"user"==e.loginType?t.getUserQuestions().then(function(o){console.log(o),e.$broadcast("scroll.refreshComplete"),o.length>0?(sessionStorage.setItem("userQuestion",JSON.stringify(o)),e.questionSorted(o)):e.noQuestionFound=!0},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}):t.getMonkAnsweredQuestion(g).then(function(o){e.$broadcast("scroll.refreshComplete"),e.questionSortedMonk(o,"answered","pullToRefresh")},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},e.slideHasChanged=function(e){console.log(e)},e.goToQuestion=function(e){a.id=e,o.go("app.singlequestion",a)},e.inputSearch=function(){e.search.searchInput?e.showClear=!0:e.showClear=!1},e.clearSearch=function(){e.search.searchInput="",e.showClear=!1}}]),askmonkApp.controller("directQuestionCtrl",["$scope","utility","$state","$stateParams",function(e,o,t,n){e.noQuestionFound=!1,e.search={searchInput:""},e.showClear=!1,e.$on("$ionicView.beforeEnter",function(){e.showLoader()});var a=0;e.noMoreQuestion=!1,o.getDirectQuestion(a).then(function(o){e.hideLoader(),console.log(o),o.length>0?e.groups=o:e.noQuestionFound=!0},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}),e.doRefresh=function(){a=0,e.noMoreQuestion=!1,o.getDirectQuestion(a).then(function(o){e.$broadcast("scroll.refreshComplete"),console.log(o),o.length>0?e.groups=o:e.noQuestionFound=!0},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.loadMoreQuestion=function(){a+=10,e.showLoader(),o.getDirectQuestion(a).then(function(o){e.hideLoader(),console.log(o,"answered"),0==o.length&&a>9?(e.noMoreQuestion=!0,e.$broadcast("scroll.infiniteScrollComplete")):(angular.forEach(o,function(o,t){e.groups.push(o)}),e.$broadcast("scroll.infiniteScrollComplete"))},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.goToQuestion=function(e){n.id=e,t.go("app.singlequestion",n)},e.inputSearch=function(){e.search.searchInput?e.showClear=!0:e.showClear=!1},e.clearSearch=function(){e.showClear=!1,e.search.searchInput=""}}]),askmonkApp.controller("draftQuestionCtrl",["$scope","utility","$state","$stateParams",function(e,o,t,n){e.noQuestionFound=!1,e.search={searchInput:""},e.showClear=!1,e.$on("$ionicView.beforeEnter",function(){e.showLoader()});var a=0;e.noMoreQuestion=!1,o.monkDraftQuestion().then(function(o){e.hideLoader(),console.log(o),o.length>0?e.groups=o:e.noQuestionFound=!0},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)}),e.doRefresh=function(){a=0,e.noMoreQuestion=!1,o.monkDraftQuestion().then(function(o){e.$broadcast("scroll.refreshComplete"),console.log(o),o.length>0?e.groups=o:e.noQuestionFound=!0},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.goToQuestion=function(e){n.id=e,t.go("app.singlequestion",n)},e.inputSearch=function(){e.search.searchInput?e.showClear=!0:e.showClear=!1},e.clearSearch=function(){e.showClear=!1,e.search.searchInput=""}}]),askmonkApp.controller("editProfileCtrl",["$scope","$state","CONSTANT","$rootScope","utility","$timeout","getMoonSign",function(e,o,t,n,a,s,i){function r(o){"Invalid Date"!=new Date(o)&&(e.showDate=!0,e.datepickerObject.inputDate=o,e.selectedDate=o),e.editProfileData.dob=angular.copy(e.datepickerObject.inputDate)}e.authenticated&&(e.loginType=t.loginType,"user"==e.loginType&&(e.showLoader(),a.getUserCount().then(function(o){e.getUserCount=o,e.hideLoader()},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})),e.showDate=!1,t.isComingFromSignUp&&e.$emit("updateEditProfileFirstUser"),n.profileData?(e.editProfileData=angular.copy(n.profileData),"user"==e.loginType&&e.editProfileData.birthTime&&(e.editProfileData.birthTime=new Date(e.editProfileData.birthTime))):localStorage.getItem("profileData")?e.editProfileData=JSON.parse(localStorage.getItem("profileData")):e.editProfileData={},console.log(e.editProfileData),s(function(){e.editProfileData.birthPlace&&angular.element(document.getElementsByClassName("ion-google-place")).addClass("used"),e.editProfileData.birthTime&&angular.element(document.getElementsByClassName("ion-birth-time")).addClass("used")},50),e.editProfileData.dob?(e.showDate=!0,e.selectedDate=angular.copy(e.editProfileData.dob)):(e.showDate=!1,e.selectedDate=""),e.datepickerObject={titleLabel:"Date Of Birth",lowDateTitleLabel:"DOB",todayLabel:"Today",closeLabel:"Close",setLabel:"Set",setButtonType:"button-askmonk",todayButtonType:"button-askmonk",closeButtonType:"button-askmonk",inputDate:e.editProfileData.dob?new Date(e.editProfileData.dob):new Date,mondayFirst:!0,templateType:"popup",showTodayButton:"false",modalHeaderColor:"bar-positive",
modalFooterColor:"bar-positive",from:new Date(1940,1,1),to:new Date,callback:function(e){!e||(new Date).getFullYear()==e.getFullYear()&&(new Date).getDate()==e.getDate()||r(e)},dateFormat:"dd-MM-yyyy",closeOnSelect:!0},e.timePickerObject12Hour={inputEpochTime:e.editProfileData.birthTime?60*new Date(e.editProfileData.birthTime).getHours()*60+60*new Date(e.editProfileData.birthTime).getMinutes():60*(new Date).getHours()*60+60*(new Date).getMinutes(),step:1,format:12,titleLabel:"Birth Time",closeLabel:"Close",setLabel:"Set",setButtonType:"button-askmonk",closeButtonType:"button-askmonk",callback:function(e){timePicker12Callback(e)}},e.timePicker12Callback=function(){angular.element(document.getElementsByClassName("ion-birth-time")).addClass("used")},e.expandText=function(){var e=document.getElementById("bioTextarea");e.style.height=e.scrollHeight+"px"},e.saveEditProfile=function(){if(e.showLoader(),"user"==e.loginType){if(!(e.editProfileData.dob&&e.editProfileData.birthPlace&&e.editProfileData.birthTime&&e.editProfileData.gender&&e.editProfileData.mobile&&e.editProfileData.name&&e.editProfileData.maritalStatus&&e.editProfileData.profession&&e.editProfileData.qualification&&e.editProfileData.numberOfChildren))return e.hideLoader(),void e.showMessage("All fields are required");if(10!=e.editProfileData.mobile.toString().length)return e.hideLoader(),void e.showMessage("Please enter the valid mobile number");a.updateUserProfile(i(e.editProfileData)).then(function(n){e.hideLoader(),t.isComingFromSignUp=!1,localStorage.removeItem("profileData"),localStorage.setItem("name",e.editProfileData.name),localStorage.setItem("profile",JSON.stringify(n)),localStorage.firstTime&&localStorage.setItem("firstTimeUser",!0),e.$emit("updateEditProfileFirstUser"),o.go("app.profile"),e.getUserCount.emailVerified||e.showMessage("Email Sent. Please Verify!")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})}else{if(!(e.editProfileData.name&&e.editProfileData.phone&&e.editProfileData.education&&e.editProfileData.residence&&e.editProfileData.experience&&e.editProfileData.city&&e.editProfileData.state&&e.editProfileData.country))return e.hideLoader(),void e.showMessage("All fields are required");a.updateMonkProfile(e.editProfileData).then(function(n){e.hideLoader(),t.isComingFromSignUp=!1,localStorage.removeItem("profileData"),localStorage.setItem("name",e.editProfileData.name),localStorage.setItem("profile",JSON.stringify(n)),e.$emit("updateEditProfileFirstUser"),o.go("app.profile")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})}},e.enableFocus=!1,e.opendSelect=function(){e.enableFocus=!e.enableFocus})}]),askmonkApp.controller("fullPackagesCtrl",["$scope","utility","$state","$ionicPopup","CONSTANT","$ionicModal",function(e,o,t,n,a,s){e.args={email:localStorage.email,userId:localStorage.userId,question:"",questionTag:"",amount:"",durationMonths:""},sessionStorage.fullPackage?e.packages=JSON.parse(sessionStorage.fullPackage):(e.showLoader(),o.getFullPackages().then(function(o){e.hideLoader(),e.packages=o,sessionStorage.setItem("fullPackage",JSON.stringify(o))},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})),o.getUserCount().then(function(o){e.getUserCount=o},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}),e.selectedPackage=function(o){console.log(o),e.selectedPackageDetails=o,e.args.question=o.name,e.args.questionTag=o.questionTag,e.args.displayTag=o.displayTag,e.args.amount=o.amount,e.args.durationMonths=o.durationMonths;var t=n.show({cssClass:"ios",title:"Please Select Preferred Language",buttons:[{text:"English",type:"button-ios button-clear noBold",onTap:function(e){return"english"}},{text:"Hindi",type:"button-ios button-clear",onTap:function(e){return"hindi"}}]});t.then(function(o){o&&(e.args.languageSelection=o,e.goTopaymentModal())})},e.startPostingQuestion=function(t,n,a){e.amount=1;var s={userId:localStorage.userId,email:localStorage.email,paymentId:t,transactionId:n,paymentType:a,amount:e.amount};o.addMoney(s).then(function(o){e.showMessage("Transaction successful"),localStorage.profile=JSON.stringify(o),e.postQuestion()},function(o){e.hideLoader(),o?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},e.goTopaymentModal=function(){return e.getUserCount.emailVerified?void s.fromTemplateUrl("paymentAnalysisDetailsModal.html",function(o){e.paymentDetailsModal=o,e.paymentDetailsModal.show()},{scope:e,animation:"slide-in-right",hardwareBackButtonClose:!0}):void e.showMessage("Please verify your email")},e.postQuestion=function(){return e.getUserCount.emailVerified?void o.postQuestionPackages(e.args).then(function(n){o.getUserCount().then(function(o){var n=JSON.parse(localStorage.profile);n.totalQuestionsAsked=o.totalQuestionsAsked,localStorage.setItem("updateDashboard",!0),localStorage.profile=JSON.stringify(n),e.hideLoader(),e.closeModal(),t.go("app.dashboard")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}):void e.showMessage("Please verify your email")},e.closeModal=function(){e.paymentDetailsModal&&e.paymentDetailsModal.isShown()&&e.paymentDetailsModal.remove()}}]),askmonkApp.controller("paymentAnalysisDetailsModalCtrl",["$scope","base64Encoding","CONSTANT",function(e,o,t){console.log(e.selectedPackageDetails),e.paymentAskQuestion=angular.copy(e.selectedPackageDetails),e.totalAmount=e.paymentAskQuestion.amount,e.serviceTax=.15*e.totalAmount,e.basicCost=e.totalAmount-e.serviceTax,e.payWithPayU=function(){e.showLoader();var o,t=window.open("https://www.payumoney.com/paybypayumoney/#/121195","_blank","location=no");t.addEventListener("loadstart",function(n){if(n.url.indexOf("payumoney")>-1&&n.url.indexOf("payment/notification/success")>-1){o=n.url.split("/")[n.url.split("/").length-1];var a="payUMoney",s="121195-"+o;t.close(),e.startPostingQuestion(o,s,a)}}),t.addEventListener("exit",function(t){"undefined"!=typeof o&&o||(e.hideLoader(),e.showMessage("Transaction Cancelled"),alert(t.type))})};var n=function(o){console.log(o);var t="paytm",n=o.ORDERID,a=o.TXNID;e.startPostingQuestion(a,n,t)},a=function(o){e.hideLoader(),console.log(o)};e.payWithPayTm=function(){e.showLoader();var t=o.encode("ASKMONK|"+Date.now()),s=localStorage.userId,i=localStorage.email,r=JSON.parse(localStorage.profile).mobile,l=e.totalAmount;window.plugins.paytm.startPayment(t,s,i,r,l,n,a)}}]),askmonkApp.controller("horoscopeCtrl",["$scope","$ionicModal","$state",function(e,o,t){e.zodiacSigns=[{id:1,name:"Aries",imagePath:"img/moonSign/icon-sign-1.svg"},{id:2,name:"Taurus",imagePath:"img/moonSign/icon-sign-2.svg"},{id:3,name:"Gemini",imagePath:"img/moonSign/icon-sign-3.svg"},{id:4,name:"Cancer",imagePath:"img/moonSign/icon-sign-4.svg"},{id:5,name:"Leo",imagePath:"img/moonSign/icon-sign-5.svg"},{id:6,name:"Virgo",imagePath:"img/moonSign/icon-sign-6.svg"},{id:7,name:"Libra",imagePath:"img/moonSign/icon-sign-7.svg"},{id:8,name:"Scorpio",imagePath:"img/moonSign/icon-sign-8.svg"},{id:9,name:"Sagittarius",imagePath:"img/moonSign/icon-sign-9.svg"},{id:10,name:"Capricorn",imagePath:"img/moonSign/icon-sign-10.svg"},{id:11,name:"Aquarius",imagePath:"img/moonSign/icon-sign-11.svg"},{id:12,name:"Pisces",imagePath:"img/moonSign/icon-sign-12.svg"}],e.clickedSign=function(t){e.signId=angular.copy(t),e.showLoader(),o.fromTemplateUrl("views/singleHoroscopeModal.html",function(o){e.singleHoroscopeModal=o,e.singleHoroscopeModal.show()},{scope:e,animation:"slide-in-right"})},e.closeModal=function(){e.singleHoroscopeModal&&e.singleHoroscopeModal.isShown()&&e.singleHoroscopeModal.remove()},e.askQuestion=function(){e.closeModal(),t.go("app.askQuestion")}}]),askmonkApp.controller("singleHoroscopeModalCtrl",["$scope","utility","$timeout",function(e,o,t){o.getHoroscope(e.signId).then(function(o){e.hideLoader(),e.detailHoroscope=o,t(function(){e.floatingBtnAction=!0},10)},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})}]),askmonkApp.controller("loginCtrl",["$scope","$state","utility","CONSTANT","$ionicScrollDelegate","$timeout","$rootScope","$stateParams","$ionicModal","$ionicSlideBoxDelegate","base64Encoding","$q",function(e,o,t,n,a,s,i,r,l,u,c,g){if(e.authenticated)"underObeservation"==localStorage.getItem("questionStatus")?(r.id=localStorage.getItem("questionId"),o.go("app.singlequestion",r)):o.go("app.profile");else{e.monkTab=!0,e.userForgetPasswordShow=!1,e.userResendValidatonShow=!1,e.monkForgetPasswordShow=!1,e.hideLoader(),e.showNextButton=!0,e.args={email:"",password:"",ttl:435456e6},e.argsSignup={name:"",email:"",password:""},e.conpassword={pass:""},e.argsMonk={email:"",password:"",ttl:435456e6},e.$on("$ionicView.loaded",function(){s(function(){analytics.trackView("Login");for(var e=1;4>e;e++){var o=angular.element(document.getElementById("video"+e));o[0].load()}},1e3)}),e.slideHasChanged=function(o){var t=angular.element(document.getElementById("video"+o));o>0&&(t[0].currentTime=0,t[0].play()),3==o?e.showNextButton=!1:e.showNextButton=!0},e.changeToNextSlide=function(){u.next()},e.openTnC=function(){return window.open("http://askmonk.in/privacy.html","_system","location=yes"),!1},e.userLoginForm=function(){e.userForgetPasswordShow=!1,e.monkForgetPasswordShow=!1,e.userResendValidatonShow=!1,e.args.email="",e.argsMonk.email="",e.userLoginModal&&e.userLoginModal.isShown()&&e.userLoginModal.remove(),l.fromTemplateUrl("userLoginModal.html",function(o){e.userLoginModal=o,e.userLoginModal.show()},{scope:e,animation:"slide-in-up"})},e.monkLoginForm=function(){e.userForgetPasswordShow=!1,e.monkForgetPasswordShow=!1,e.userResendValidatonShow=!1,e.args.email="",e.argsMonk.email="",e.monkLoginModal&&e.monkLoginModal.isShown()&&e.monkLoginModal.remove(),l.fromTemplateUrl("monkLoginModal.html",function(o){e.monkLoginModal=o,e.monkLoginModal.show()},{scope:e,animation:"slide-in-up"})},e.signUpTab=function(){e.monkTab=!1,e.signUptab=!0,s(function(){a.$getByHandle("loginScroll").scrollTo(0,50,!0)},10)},e.loginTab=function(){e.monkTab=!0,e.signUptab=!1,e.userForgetPasswordShow=!1,e.userResendValidatonShow=!1,e.args.email=""},e.loginMonkTab=function(){e.monkForgetPasswordShow=!1,e.argsMonk.email=""},e.forgetUserPasswordTab=function(){e.userForgetPasswordShow=!0,e.userResendValidatonShow=!1,e.args.email=""},e.resendValidationTab=function(){e.userForgetPasswordShow=!0,e.userResendValidatonShow=!0,e.args.email=""},e.forgetMonkPasswordTab=function(){e.monkForgetPasswordShow=!0,e.argsMonk.email=""},e.userLogin=function(a){return a.userEmail.$viewValue&&a.userEmail.$valid?a.userPassword.$viewValue&&a.userPassword.$valid?(e.showLoader(),void t.login(e.args).then(function(t){analytics.trackEvent("Login","Click","User_Login_Button",1),e.args.password="",e.setAuth(!0),localStorage.setItem("loginType","user"),n.loginType="user",e.hideLoader(),e.userLoginModal&&e.userLoginModal.isShown()&&e.userLoginModal.remove(),o.go("app.profile"),e.registerNotificaton()},function(o){e.hideLoader(),o?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),e.showMessage(o.error.message)})):void e.showMessage("Please enter the correct password"):void e.showMessage("Please enter the correct email address")},e.monkLogin=function(){e.showLoader(),n.isDevice&&cordova.plugins.Keyboard.close(),t.monkLogin(e.argsMonk).then(function(t){analytics.trackEvent("Login","Click","Monk_Login_Button",1),e.argsMonk.password="",e.setAuth(!0),localStorage.setItem("loginType","monk"),n.loginType="monk",e.hideLoader(),e.monkLoginModal&&e.monkLoginModal.isShown()&&e.monkLoginModal.remove(),o.go("app.profile"),e.registerNotificaton()},function(o){e.hideLoader(),o?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},e.userSignUp=function(a){return a.email.$viewValue&&a.email.$valid?a.password.$viewValue&&a.password.$valid?""!=e.conpassword.pass&&e.argsSignup.password!=e.conpassword.pass?void e.showMessage("Sorry, the passwords do not match"):""==e.argsSignup.name||""==e.argsSignup.email||""==e.argsSignup.password?void e.showMessage("All fields are required"):a.$valid?(e.showLoader(),n.isDevice&&cordova.plugins.Keyboard.close(),t.register(e.argsSignup).then(function(a){n.isComingFromSignUp=!0,localStorage.setItem("name",a.name),localStorage.setItem("email",a.email),t.login({email:a.email,password:e.argsSignup.password}).then(function(t){analytics.trackEvent("Sign Up","Click","User_Signup_Button",1),e.argsSignup={name:"",email:"",password:""},e.conpassword={pass:""},i.token=localStorage.getItem("token"),localStorage.setItem("profileData",JSON.stringify(a)),localStorage.setItem("firstTime",!0),e.setAuth(!0),localStorage.setItem("loginType","user"),n.loginType="user",e.hideLoader(),e.userLoginModal&&e.userLoginModal.isShown()&&e.userLoginModal.remove(),o.go("app.editProfile"),e.registerNotificaton()},function(o){e.hideLoader(),o?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},function(o){e.hideLoader(),o&&422==o.error.status?e.showMessage("Email address is already register"):e.showMessage("Something went wrong. Please try again.")}),void 0):void e.showMessage("Please share the right details"):void e.showMessage("Minimum password limit 6."):void e.showMessage("Please enter the correct email address")},e.userForgetPassword=function(){e.showLoader(),t.forgetUserPassword(c.encode(e.args.email)).then(function(o){analytics.trackEvent("Forgot Password","Click","User_Forgot_Password_Submit",1),e.hideLoader(),e.userLoginForm(),e.showMessage("Mail sent")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.userResendValidation=function(){e.showLoader(),t.resendValidationUser(c.encode(e.args.email)).then(function(o){analytics.trackEvent("Resend Validation","Click","User_Resend_Validation_Submit",1),e.hideLoader(),e.userLoginForm(),e.showMessage("Mail sent")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.monkForgetPassword=function(){e.showLoader(),t.forgetMonkPassword(c.encode(e.argsMonk.email)).then(function(o){analytics.trackEvent("Forgot Password","Click","Monk_Forgot_Password_Submit",1),e.hideLoader(),e.monkLoginForm(),e.showMessage("Mail sent")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.closeModal=function(){e.userLoginModal&&e.userLoginModal.isShown()&&e.userLoginModal.remove(),e.monkLoginModal&&e.monkLoginModal.isShown()&&e.monkLoginModal.remove()},e.userGoogleLogin=function(){e.showLoader(),window.plugins.googleplus.login({androidApiKey:"915609605128-u216nkp9epffsf24mtgeu7qe7b1g2g7a.apps.googleusercontent.com"},function(a){t.googleOauth(a).then(function(t){analytics.trackEvent("Login","Click","User_Google_Login_Button",1),e.setAuth(!0),localStorage.setItem("loginType","user"),localStorage.setItem("token",t.id),localStorage.setItem("userId",t.userId),n.loginType="user",t.firstTimeLogin?(localStorage.setItem("firstTime",!0),localStorage.setItem("name",a.givenName),localStorage.setItem("email",a.email),i.profileData=angular.copy(a),i.profileData.name=angular.copy(i.profileData.displayName),n.isComingFromSignUp=!0,o.go("app.editProfile")):o.go("app.profile"),e.userLoginModal&&e.userLoginModal.isShown()&&e.userLoginModal.remove(),e.registerNotificaton(),e.hideLoader()},function(o){e.hideLoader(),o&&422==o.status?e.showMessage(o.msg):e.showMessage("Something went wrong. Please try again."),console.log("error",o)})},function(o){e.hideLoader(),console.log(JSON.stringify(o),"error")})},e.finalFacebookLogin=function(a){t.facebookOauth({name:a.name,email:a.email,gender:a.gender,image:"http://graph.facebook.com/"+a.id+"/picture?type=large"}).then(function(t){analytics.trackEvent("Login","Click","User_Facebook_Login_Button",1),e.setAuth(!0),localStorage.setItem("loginType","user"),localStorage.setItem("token",t.id),localStorage.setItem("userId",t.userId),n.loginType="user",t.firstTimeLogin?(localStorage.setItem("firstTime",!0),localStorage.setItem("name",a.name),localStorage.setItem("email",a.email),a.id&&delete a.id,i.profileData=angular.copy(a),n.isComingFromSignUp=!0,o.go("app.editProfile")):o.go("app.profile"),e.userLoginModal&&e.userLoginModal.isShown()&&e.userLoginModal.remove(),e.registerNotificaton(),e.hideLoader()},function(o){e.hideLoader(),o&&422==o.status?e.showMessage(o.msg):e.showMessage("Something went wrong. Please try again."),console.log("error",o)})};var d=function(o){return o.authResponse?void p(o.authResponse).then(function(o){e.finalFacebookLogin(o)},function(o){e.hideLoader(),e.showMessage("Something went wrong. Please try again.")}):void m("Cannot find the authResponse")},m=function(o){e.hideLoader(),e.showMessage("Something went wrong. Please try again."),console.log("fbLoginError",o)},p=function(o){e.showLoader();var t=g.defer();return facebookConnectPlugin.api("/me?fields=email,name,gender&access_token="+o.accessToken,null,function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise};e.userFacebookLogin=function(){facebookConnectPlugin.getLoginStatus(function(o){"connected"===o.status?p(o.authResponse).then(function(o){e.finalFacebookLogin(o)},function(o){e.hideLoader(),e.showMessage("Something went wrong. Please try again.")}):facebookConnectPlugin.login(["email","public_profile"],d,m)})}}}]),askmonkApp.filter("trusted",["$sce",function(e){return function(o){return e.trustAsResourceUrl(o)}}]),askmonkApp.controller("openQuestionCtrl",["$scope","utility","$state","$stateParams",function(e,o,t,n){e.noQuestionFound=!1,e.search={searchInput:""},e.showClear=!1,e.$on("$ionicView.beforeEnter",function(){e.showLoader()});var a=0;e.noMoreQuestion=!1,o.getQuestionOnStatus("asked",a).then(function(o){e.hideLoader(),console.log(o),o.length>0?e.groups=o:e.noQuestionFound=!0},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)}),e.doRefresh=function(){a=0,e.noMoreQuestion=!1,o.getQuestionOnStatus("asked",a).then(function(o){e.$broadcast("scroll.refreshComplete"),console.log(o),o.length>0?e.groups=o:e.noQuestionFound=!0},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.loadMoreQuestion=function(){a+=10,e.showLoader(),o.getQuestionOnStatus("asked",a).then(function(o){console.log(o,"asked"),e.hideLoader(),0==o.length&&a>9?(e.noMoreQuestion=!0,e.$broadcast("scroll.infiniteScrollComplete")):(angular.forEach(o,function(o,t){e.groups.push(o)}),e.$broadcast("scroll.infiniteScrollComplete"))},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.goToQuestion=function(e){n.id=e,t.go("app.singlequestion",n)},e.inputSearch=function(){e.search.searchInput?e.showClear=!0:e.showClear=!1},e.clearSearch=function(){e.showClear=!1,e.search.searchInput=""}}]),askmonkApp.controller("profileCtrl",["$scope","$state","utility","CONSTANT","$rootScope","$timeout","$ionicPopup","$stateParams","$ionicModal","$filter",function(e,o,t,n,a,s,i,r,l,u){e.floatingBtnAction=!1,e.floatingBtnLabel=!1,e.$on("$ionicView.enter",function(){e.floatingBtnAction=!0,s(function(){e.floatingBtnLabel=!0},630),n.isDevice&&cordova.plugins.Keyboard.close()});var c=0;e.noMoreQuestion=!1,e.loginType=n.loginType,localStorage.getItem("profile")?(a.profileData=JSON.parse(localStorage.getItem("profile")),e.profileInfo=angular.copy(a.profileData),console.log(e.profileInfo),"user"==e.loginType?(e.profileInfo.profilePic?e.profileImage=angular.copy(e.profileInfo.profilePic):e.profileImage="img/moonSign/"+e.profileInfo.moonSign+".png",s(function(){e.getBroadcastQuestion()})):e.profileImage="http://askmonk.in/mImages/"+e.profileInfo.email.split("@")[0].toLowerCase()+".jpg"):"user"==e.loginType?t.getUserProfile(localStorage.getItem("userId")).then(function(t){localStorage.setItem("email",t.email),localStorage.setItem("name",t.name),e.$emit("updateSideMenuName",t),a.profileData=t,t.dob&&t.birthPlace&&t.birthTime&&t.gender?(localStorage.setItem("profile",JSON.stringify(t)),e.profileInfo=angular.copy(a.profileData),e.profileInfo.profilePic?e.profileImage=angular.copy(e.profileInfo.profilePic):e.profileImage="img/moonSign/"+e.profileInfo.moonSign+".png",e.getBroadcastQuestion()):(localStorage.setItem("firstTime",!0),n.isComingFromSignUp=!0,o.go("app.editProfile"))},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)}):t.getMonkProfile().then(function(s){localStorage.setItem("email",s.email),localStorage.setItem("name",s.name),e.$emit("updateSideMenuName",s),a.profileData=s,s.name&&s.phone&&s.education&&s.residence&&s.experience?(e.hideLoader(),localStorage.setItem("profile",JSON.stringify(s)),e.$emit("updateAvaliableStatus"),e.profileInfo=angular.copy(a.profileData),e.profileImage="http://askmonk.in/mImages/"+e.profileInfo.email.split("@")[0].toLowerCase()+".jpg",t.getDirectQuestionCount().then(function(o){o.count>0&&e.showDirectQuestionCountPopup(o)},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})):(n.isComingFromSignUp=!0,o.go("app.editProfile"))},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)}),localStorage.firstTimeUser&&(localStorage.removeItem("firstTimeUser"),localStorage.removeItem("firstTime"),e.guideScreenImage=[1,2,3,4,5,6,7,8,9,10],l.fromTemplateUrl("views/guideScreenModal.html",function(o){e.guideScreenModal=o,e.guideScreenModal.show()},{scope:e,animation:"slide-in-right"})),"user"==e.loginType?(t.getUserCount().then(function(o){e.getUserCount=o,console.log(o)},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)}),localStorage.timelineJson||t.getTimeLineJson().then(function(e){localStorage.setItem("timelineJson",JSON.stringify(e))},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}),localStorage.tagQuestion||t.getAllQuestion().then(function(e){localStorage.setItem("tagQuestion",JSON.stringify(e))},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})):(e.showLoader(),t.getMonkCount().then(function(o){e.getMonkCount=o,e.hideLoader()},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})),e.getBroadcastQuestion=function(){sessionStorage.broadcastquestion?e.broadcastQuestions=JSON.parse(sessionStorage.broadcastquestion):(e.showLoader(),t.getbroadcastArticle(c).then(function(o){e.hideLoader(),e.broadcastQuestions=o,sessionStorage.setItem("broadcastquestion",JSON.stringify(o))},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)}))},e.color=function(e){if(e.color)return e.color;var o="012345".split(""),t="#";t+=o[Math.round(5*Math.random())],o="0123456789ABCDEF".split("");for(var n=0;5>n;n++)t+=o[Math.round(15*Math.random())];return e.color=t,t},e.doRefresh=function(){c=0,e.noMoreQuestion=!1,e.showLoader(),t.getbroadcastArticle(c).then(function(o){e.hideLoader(),e.broadcastQuestions=o,sessionStorage.setItem("broadcastquestion",JSON.stringify(o)),e.$broadcast("scroll.refreshComplete")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.loadMoreQuestion=function(){c+=10,e.showLoader(),t.getbroadcastArticle(c).then(function(o){console.log(o,"broadcast"),e.hideLoader(),0==o.length&&c>9?(e.noMoreQuestion=!0,e.$broadcast("scroll.infiniteScrollComplete")):(angular.forEach(o,function(o,t){e.broadcastQuestions.push(o)}),e.$broadcast("scroll.infiniteScrollComplete"))},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})},e.goToArticle=function(e){r.id=e,o.go("app.broadcastquestion",r)},e.showDirectQuestionCountPopup=function(t){var n=i.show({cssClass:"ios",title:t.count+" direct questions unanswered.",template:"Want to answer now?",scope:e,buttons:[{text:"Ok",type:"button-ios button-clear",onTap:function(e){return!0}},{text:"Cancel",type:"button-ios button-clear",onTap:function(e){return!1}}]});n.then(function(e){e?(console.log("You are sure"),o.go("app.directQuestion")):console.log("You are not sure")})},e.profileEdit=function(){o.go("app.editProfile")},e.moonSignName=function(){e.showMessage("Hi "+u("capitalize")(e.profileInfo.moonSign))},e.askQuestion=function(){o.go("app.askQuestion")},e.closeModal=function(){e.guideScreenModal&&e.guideScreenModal.isShown()&&e.guideScreenModal.remove()}}]),askmonkApp.controller("settingCtrl",["$scope","utility","$ionicHistory","$rootScope","$http","$state","$templateCache","$ionicModal","$ionicPopup","CONSTANT",function(e,o,t,n,a,s,i,r,l,u){e.loginType=u.loginType,e.noPaymentFound=!1,e.userModal=JSON.parse(localStorage.profile),e.aboutUs=function(){r.fromTemplateUrl("views/aboutUsModal.html",function(o){e.aboutUsModal=o,e.aboutUsModal.show()},{scope:e,animation:"slide-in-right"})},e.privacyPolicy=function(){return window.open("http://askmonk.in/privacy.html","_system","location=yes"),!1},e.termsCondition=function(){return window.open("http://askmonk.in/tandc.html","_system","location=yes"),!1},e.openBlog=function(){return window.open("https://askmonkblog.wordpress.com","_system","location=yes"),!1},e.rateUsApp=function(){var e=window.open("market://details?id=com.askmonk.in");e.addEventListener("loadstop",function(o){e.close()})},e.payGoogleWallet=function(){var e=window.open("https://www.payumoney.com/paybypayumoney/#/121195","_blank","location=no");e.addEventListener("loadstart",function(e){if(e.url.indexOf("payumoney")>-1&&e.url.indexOf("payment/notification/success")>-1){e.url.split("/")[e.url.split("/").length-1]}}),e.addEventListener("loadstop",function(o){e.close(),o.url.indexOf("payumoney")>-1&&alert("stop: "+o.url)}),e.addEventListener("loaderror",function(e){alert("error: "+e.message)}),e.addEventListener("exit",function(e){alert(e.type)})},e.getPaymentInfo=function(){e.showLoader(),"user"==e.loginType?o.userPaymentInfo().then(function(o){e.hideLoader(),e.paymentReceipts=o,0==e.paymentReceipts.length&&(e.noPaymentFound=!0),r.fromTemplateUrl("paymentInfoModal.html",function(o){e.paymentInfoModal=o,e.paymentInfoModal.show()},{scope:e,animation:"slide-in-right"})},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}):o.monkPaymentInfo().then(function(o){e.hideLoader(),e.paymentReceipts=o,0==e.paymentReceipts.length&&(e.noPaymentFound=!0),r.fromTemplateUrl("paymentInfoModal.html",function(o){e.paymentInfoModal=o,e.paymentInfoModal.show()},{scope:e,animation:"slide-in-right"})},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},e.showGuideScreens=function(){e.guideScreenImage=[1,2,3,4,5,6,7,8,9,10],r.fromTemplateUrl("views/guideScreenModal.html",function(o){e.guideScreenModal=o,e.guideScreenModal.show()},{scope:e,animation:"slide-in-right"})},e.helpDesk=function(){window.plugins.socialsharing.shareViaEmail(null,null,["support@askmonk.in"],null,null,null,onSuccess=function(){e.showMessage("Please share your query")},onError=function(o){e.showMessage("Something went wrong. Please try again")})},e.shareWhatsapp=function(){e.showLoader(),window.plugins.socialsharing.shareViaWhatsApp("http://www.askmonk.in ( Innovative way to know about astrological solutions to one's crisp questions in no time. Download Askmonk now where predictions are just a question away )",null,null,function(){e.hideLoader(),console.log("share ok")},function(o){e.hideLoader(),e.showMessage("Whatsapp is not installed."),console.log(o,"error")})},e.changePassword=function(){r.fromTemplateUrl("views/changePasswordModal.html",function(o){e.changePasswordModal=o,e.changePasswordModal.show()},{scope:e,animation:"slide-in-right"})},e.resendValidation=function(){r.fromTemplateUrl("resendValidationModal.html",function(o){e.resendValidationModal=o,e.resendValidationModal.show()},{scope:e,animation:"slide-in-right"})},e.logOut=function(){var t=l.show({cssClass:"ios",title:"Do you want to logout of Askmonk?",buttons:[{text:"Yes",type:"button-ios button-clear",onTap:function(e){return!0}},{text:"No",type:"button-ios button-clear",onTap:function(e){return!1}}]});t.then(function(t){if(t)if(console.log("You are sure"),"monk"==e.loginType){var n=JSON.parse(localStorage.profile);o.updateMonkAvailableStatus({id:n.id,email:n.email,isAvailable:!1}).then(function(o){e.logout()},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})}else e.logout();else console.log("You are not sure")})},e.logout=function(){e.showLoader(),o.logout().then(function(o){s.go("login"),e.setAuth(!1),t.clearCache(),t.clearHistory();var r=s.current.templateUrl;i.remove(r),n.profileData=null,localStorage.clear(),sessionStorage.clear(),e.loginType=localStorage.getItem("loginType"),delete a.defaults.headers.common.Authorization,e.hideLoader()},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},e.closeModal=function(){e.aboutUsModal&&e.aboutUsModal.isShown()&&e.aboutUsModal.remove(),e.changePasswordModal&&e.changePasswordModal.isShown()&&e.changePasswordModal.remove(),e.resendValidationModal&&e.resendValidationModal.isShown()&&e.resendValidationModal.remove(),e.paymentInfoModal&&e.paymentInfoModal.isShown()&&e.paymentInfoModal.remove(),e.guideScreenModal&&e.guideScreenModal.isShown()&&e.guideScreenModal.remove()}}]),askmonkApp.controller("changePasswordModalCtrl",["$scope","utility","CONSTANT","$ionicPopup",function(e,o,t,n){e.model={password:""},e.args={con_password:""},e.passwordChangePopup=function(o){var t=n.show({cssClass:"ios",title:"Do you want to change your password?",buttons:[{text:"Yes",type:"button-ios button-clear",onTap:function(e){return!0}},{text:"No",type:"button-ios button-clear",onTap:function(e){return!1}}]});t.then(function(t){t?(console.log("You are sure"),e.passwordChange(o)):console.log("You are not sure")})},e.passwordChange=function(n){e.model.password&&e.args.con_password||e.showMessage("All fields are required"),e.model.password!==e.args.con_password?e.showMessage("Passwords don't match"):(e.showLoader(),"user"==t.loginType?o.changeUserPassword(e.model).then(function(o){e.hideLoader(),console.log(o,"success"),e.closeModal(),e.showMessage("Password change successfully")},function(o){
e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}):o.changeMonkPassword(e.model).then(function(o){e.hideLoader(),e.closeModal(),e.showMessage("Password change successfully")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}))}}]),askmonkApp.controller("resendValidationModalCtrl",["$scope","utility","base64Encoding",function(e,o,t){e.args={email:localStorage.email},e.resendValidationSendPopup=function(n){return""==n.email.$viewValue||n.$invalid?void e.showMessage("Please enter the correct email address"):(e.showLoader(),void o.resendValidationUser(t.encode(e.args.email)).then(function(o){e.hideLoader(),e.closeModal(),e.showMessage("Mail sent")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}))}}]),askmonkApp.controller("singleQuestionCtrl",["$scope","$state","utility","$timeout","$stateParams","CONSTANT","$ionicModal","$ionicPopup",function(e,o,t,n,a,s,i,r){e.authenticated||o.go("login"),e.floatingBtnAction=!1,e.floatingBtnLabel=!1,e.$on("$ionicView.enter",function(){e.floatingBtnAction=!0,n(function(){e.floatingBtnLabel=!0},630)}),"underObservation"==localStorage.getItem("questionStatus")&&(s.isComingFromSignUp=!0,e.$emit("writeAnswerActive")),e.loginType=s.loginType,e.ratingSubmitted=!1,e.ratingEdit=!1,e.askQuestion=function(){o.go("app.askQuestion")},e.showLoader(),t.getSingleQuestions(a.id).then(function(t){if(console.log(t),e.hideLoader(),e.question=t,"underObservation"==e.question.status&&e.question.monkId!=localStorage.userId){var n=r.alert({cssClass:"ios",title:"This question is already taken. Please try another question",buttons:[{text:"Ok",type:"button-ios button-clear",onTap:function(e){return!0}}]});n.then(function(e){o.go("app.dashboard")})}},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}),e.viewPartnerDetails=function(){i.fromTemplateUrl("views/viewPartnerDetailModal.html",function(o){e.viewPartnerDetailModal=o,e.viewPartnerDetailModal.show()},{scope:e,animation:"slide-in-right"})},e.editQuestion=function(){i.fromTemplateUrl("views/editQuestionModal.html",function(o){e.editQuestionModal=o,e.editQuestionModal.show()},{scope:e,animation:"slide-in-right"})},e.ratingEditing=function(){e.ratingEdit=!0},e.rateQuestion=function(){console.log(e.question),e.showLoader(),t.ratingQuestion({userId:localStorage.getItem("userId"),email:e.question.email,id:e.question.id,status:e.question.status,rating:e.question.rating}).then(function(o){console.log("success",o),e.hideLoader(),e.question=angular.copy(o),e.ratingSubmitted=!0,e.ratingEdit=!1},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},e.writtenAnswer=localStorage.getItem("answer"),e.openWriteModal=function(){i.fromTemplateUrl("views/writeAnswerModal.html",function(o){e.writeAnswerModal=o,e.writeAnswerModal.show()},{scope:e,animation:"slide-in-up",hardwareBackButtonClose:!0})},e.writtenSolution=localStorage.getItem("solution"),e.openWriteSolutionModal=function(){i.fromTemplateUrl("views/writeSolutionModal.html",function(o){e.writeSolutionModal=o,e.writeSolutionModal.show()},{scope:e,animation:"slide-in-up",hardwareBackButtonClose:!0})},e.userDetail=function(){i.fromTemplateUrl("views/userDetailModal.html",function(o){e.userDetailModal=o,e.userDetailModal.show()},{scope:e,animation:"slide-in-right"})},e.acceptQuestion=function(){e.showLoader(),t.acceptQuestionMonk({userId:e.question.userId,email:e.question.email,id:e.question.id,monkId:localStorage.getItem("userId"),monkEmail:localStorage.getItem("email"),status:"asked"}).then(function(o){s.isComingFromSignUp=!0,e.$emit("writeAnswerActive"),e.question=angular.copy(o),localStorage.setItem("questionStatus",e.question.status),localStorage.setItem("questionId",e.question.id),e.hideLoader(),n(function(){e.openWriteModal()},100),console.log(o,"success")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})},e.askBeforeAccept=function(){var o=r.show({cssClass:"ios",title:"After accepting a question answering it is mandatory.",template:"Do u want to proceed ?",buttons:[{text:"Yes",type:"button-ios button-clear",onTap:function(e){return!0}},{text:"No",type:"button-ios button-clear",onTap:function(e){return!1}}]});o.then(function(o){o?e.acceptQuestion():console.log("You are not sure")})},e.closeAnswerPopup=function(){e.writtenAnswer=localStorage.getItem("answer"),e.writeAnswerModal&&e.writeAnswerModal.isShown()&&e.writeAnswerModal.remove()},e.closeSolutionPopup=function(){e.writtenSolution=localStorage.getItem("solution"),e.writeSolutionModal&&e.writeSolutionModal.isShown()&&e.writeSolutionModal.remove()},e.postAnswer=function(){if(""==localStorage.getItem("answer"))return void e.showMessage("Please write your answer");if(""==localStorage.getItem("solution"))return void e.showMessage("Please write your solution");e.question.answer=localStorage.getItem("answer"),e.question.solution=localStorage.getItem("solution");var o=r.show({cssClass:"ios",title:"Going further would sent the answer to the user.",template:"Do u wish to continue ?",buttons:[{text:"Yes",type:"button-ios button-clear",onTap:function(e){return!0}},{text:"No",type:"button-ios button-clear",onTap:function(e){return!1}}]});o.then(function(o){if(o){if(!e.question.answer)return void e.showMessage("Please write answer");if(!e.question.solution)return void e.showMessage("Please write solution");e.showLoader(),console.log("You are sure"),t.submitAnswer(e.question).then(function(o){e.hideLoader(),s.isComingFromSignUp=!1,e.$emit("writeAnswerActive"),e.writtenAnswer="",localStorage.removeItem("answer"),e.writtenSolution="",localStorage.removeItem("solution"),localStorage.removeItem("questionStatus"),localStorage.removeItem("questionId"),e.question=angular.copy(o)},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)})}else console.log("You are not sure")})},e.closeEditModal=function(o){e.question=angular.copy(o),e.hideLoader(),e.editQuestionModal&&e.editQuestionModal.isShown()&&e.editQuestionModal.remove(),e.askInformationModal&&e.askInformationModal.isShown()&&e.askInformationModal.remove(),e.postInformationModal&&e.postInformationModal.isShown()&&e.postInformationModal.remove()},e.closeAskInformationModal=function(o){e.question=angular.copy(o),console.log(e.question),e.hideLoader()},e.closeModal=function(){e.userDetailModal&&e.userDetailModal.isShown()&&e.userDetailModal.remove(),e.writeAnswerModal&&e.writeAnswerModal.isShown()&&e.writeAnswerModal.remove(),e.viewPartnerDetailModal&&e.viewPartnerDetailModal.isShown()&&e.viewPartnerDetailModal.remove(),e.editQuestionModal&&e.editQuestionModal.isShown()&&e.editQuestionModal.remove(),e.askInformationModal&&e.askInformationModal.isShown()&&e.askInformationModal.remove(),e.postInformationModal&&e.postInformationModal.isShown()&&e.postInformationModal.remove()},e.showMonkPage=function(){o.go("app.yprofile",{id:e.question.monkId})},e.askInformation=function(){i.fromTemplateUrl("views/askInformationModal.html",function(o){e.askInformationModal=o,e.askInformationModal.show()},{scope:e,animation:"slide-in-right"})},e.openInformationModal=function(){i.fromTemplateUrl("views/postInformationModal.html",function(o){e.postInformationModal=o,e.postInformationModal.show()},{scope:e,animation:"slide-in-right"})}}]),askmonkApp.controller("writeAnswerModalPopupCtrl",["$scope","$timeout",function(e,o){e.writeAnswerTextarea={answer:""},localStorage.getItem("answer")&&(e.writeAnswerTextarea.answer=localStorage.getItem("answer")),e.closeWriteAnswerPopup=function(){o(function(){e.closeAnswerPopup()},250),cordova.plugins.Keyboard.close()},e.expandText=function(){localStorage.setItem("answer",e.writeAnswerTextarea.answer);var o=document.getElementById("writeAnswerTextarea");o.style.height=o.scrollHeight+"px"}}]),askmonkApp.controller("writeSolutionModalPopupCtrl",["$scope","$timeout",function(e,o){e.writeSolutionTextarea={solution:""},localStorage.getItem("solution")&&(e.writeSolutionTextarea.solution=localStorage.getItem("solution")),e.closeWriteSolutionPopup=function(){o(function(){e.closeSolutionPopup()},250),cordova.plugins.Keyboard.close()},e.expandText=function(){localStorage.setItem("solution",e.writeSolutionTextarea.solution);var o=document.getElementById("writeAnswerTextarea");o.style.height=o.scrollHeight+"px"}}]),askmonkApp.controller("userDetailModalPopupCtrl",["$scope","getMoonSign",function(e,o){e.profileInfo=angular.copy(o(e.question)),e.profileImage="img/moonSign/"+e.profileInfo.moonSign+".png"}]),askmonkApp.controller("viewPartnerDetailModalCtrl",["$scope","getMoonSign",function(e,o){e.partnerProfileInfo=angular.copy(o(e.question.matchMakingDetails)),e.partnerProfileImage="img/moonSign/"+e.partnerProfileInfo.moonSign+".png"}]),askmonkApp.controller("editQuestionModalCtrl",["$scope","utility","$timeout",function(e,o,t){function n(o){e.showDate=!0,o?e.datepickerObject.inputDate=o:e.datepickerObject.inputDate=new Date,e.editQuestion.matchMakingDetails.partnerDOB=angular.copy(e.datepickerObject.inputDate)}e.editQuestion=angular.copy(e.question),console.log(e.question),localStorage.tagQuestion?(e.questionTag=JSON.parse(localStorage.getItem("tagQuestion")),e.hideLoader()):o.getAllQuestion().then(function(o){e.hideLoader(),e.questionTag=o,localStorage.setItem("tagQuestion",JSON.stringify(o))},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)}),"Match Making"==e.editQuestion.questionTag&&(e.editQuestion.matchMakingDetails.partnerBirthTime=angular.copy(new Date(e.editQuestion.matchMakingDetails.partnerBirthTime)),e.editQuestion.matchMakingDetails.partnerDOB=angular.copy(new Date(e.editQuestion.matchMakingDetails.partnerDOB)),t(function(){e.editQuestion.matchMakingDetails.partnerBirthPlace&&angular.element(document.getElementsByClassName("ion-google-place")).addClass("used"),e.editQuestion.matchMakingDetails.partnerBirthTime&&angular.element(document.getElementsByClassName("ion-birth-time")).addClass("used")},50),e.datepickerObject={titleLabel:"DOB",todayLabel:"Today",closeLabel:"Close",setLabel:"Set",setButtonType:"button-askmonk",todayButtonType:"button-askmonk",closeButtonType:"button-askmonk",inputDate:e.editQuestion.matchMakingDetails.partnerDOB,mondayFirst:!0,templateType:"popup",showTodayButton:"false",modalHeaderColor:"bar-positive",modalFooterColor:"bar-positive",from:new Date(1940,1,1),to:new Date,callback:function(e){n(e)},dateFormat:"dd-MM-yyyy",closeOnSelect:!0},e.timePickerObject12Hour={inputEpochTime:e.editQuestion.matchMakingDetails.partnerBirthTime?60*new Date(e.editQuestion.matchMakingDetails.partnerBirthTime).getHours()*60+60*new Date(e.editQuestion.matchMakingDetails.partnerBirthTime).getMinutes():60*(new Date).getHours()*60,step:1,format:12,titleLabel:"Partner Birth Time",closeLabel:"Close",setLabel:"Set",setButtonType:"button-askmonk",closeButtonType:"button-askmonk",callback:function(e){timePicker12Callback(e)}},e.timePicker12Callback=function(e){angular.element(document.getElementsByClassName("ion-birth-time")).addClass("used")}),e.saveEditQuestion=function(){e.showLoader(),o.editQuestion(e.editQuestion).then(function(o){console.log(o,"success"),e.closeEditModal(o)},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o,"error")})}}]),askmonkApp.controller("askInformationModalCtrl",["$scope","utility","$ionicPopup",function(e,o,t){e.editQuestion=angular.copy(e.question),console.log(e.editQuestion),e.modal={monkId:localStorage.userId,monkEmail:localStorage.email,monkName:localStorage.name,userId:e.editQuestion.userId,id:e.editQuestion.id,status:e.editQuestion.status,askInformation:""},localStorage.tagQuestion?(e.questionTag=JSON.parse(localStorage.getItem("tagQuestion")),e.hideLoader()):o.getAllQuestion().then(function(o){e.hideLoader(),e.questionTag=o,localStorage.setItem("tagQuestion",JSON.stringify(o))},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o)}),e.postInformation=function(){if(!e.modal.askInformation)return void e.showMessage("Please write desired information");var n=t.show({cssClass:"ios",title:"Asking information to user would make this question mandatory for you to answer.",template:"Do u wish to continue ?",buttons:[{text:"Yes",type:"button-ios button-clear",onTap:function(e){return!0}},{text:"No",type:"button-ios button-clear",onTap:function(e){return!1}}]});n.then(function(t){t?(e.showLoader(),o.postInformation(e.modal).then(function(o){e.hideLoader(),e.closeEditModal(o),e.showMessage("Information has been sent to user")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o,"error")})):console.log("You are not sure")})}}]),askmonkApp.controller("postInformationModalCtrl",["$scope","utility","$ionicPopup",function(e,o,t){e.editQuestion=angular.copy(e.question),console.log(e.editQuestion),e.modal={monkId:localStorage.userId,userId:e.editQuestion.userId,id:e.editQuestion.id,status:e.editQuestion.status,answerInformation:""},e.postInformation=function(){if(!e.modal.answerInformation)return void e.showMessage("Please ask the desired information");var n=t.show({cssClass:"ios",title:"Going further would sent the information to the monk.",template:"Do u wish to continue ?",buttons:[{text:"Yes",type:"button-ios button-clear",onTap:function(e){return!0}},{text:"No",type:"button-ios button-clear",onTap:function(e){return!1}}]});n.then(function(t){t?(e.showLoader(),o.postAnswerInformation(e.modal).then(function(o){e.hideLoader(),e.closeEditModal(o),e.showMessage("Information has been sent to monk")},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),console.log(o,"error")})):console.log("You are not sure")})}}]),askmonkApp.controller("walletCtrl",["$scope","utility","$state","CONSTANT","$timeout",function(e,o,t,n,a){function s(o){"native.keyboardshow"==o.type?a(function(){e.floatingBtnAction=!1},200):e.floatingBtnAction=!0}e.floatingBtnAction=!1,e.$on("$ionicView.enter",function(){e.floatingBtnAction=!0}),e.loginType=n.loginType,e.money={customMoney:"200"},window.addEventListener("native.keyboardshow",s),window.addEventListener("native.keyboardhide",s),e.askQuestion=function(){t.go("app.askQuestion")},"user"==e.loginType?(e.showLoader(),o.getUserCount().then(function(o){e.walletMoney=o.walletMoney,e.hideLoader()},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})):(e.showLoader(),o.getMonkCount().then(function(o){e.walletMoney=o.walletMoney,e.totalWalletMoney=o.totalWalletMoney,e.hideLoader()},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})),e.options=function(o){e.amount=100*o.amount;var t=JSON.parse(localStorage.profile),a={description:o.name,currency:"INR",image:n.razorPayImage,key:n.razorPayKey,amount:e.amount,name:"Askmonk",prefill:{email:t.email,contact:t.mobile,name:t.name},theme:{color:"#00BCD2"}};return a};var i=function(t){t?(e.showLoader(),o.addMoney({userId:localStorage.getItem("userId"),email:localStorage.getItem("email"),amount:e.amount,payment_id:t,paymentType:"razorPay"}).then(function(o){e.hideLoader(),e.showMessage("Transaction successful"),e.walletMoney=o.walletMoney,localStorage.profile=JSON.stringify(o)},function(o){e.showMessage("Something went wrong. Try again")})):e.showMessage("Something went wrong. Try again")},r=function(o){e.showMessage(o.description)};e.getPayment=function(o){RazorpayCheckout.open(e.options(o),i,r)},e.addCustomMoney=function(o){o.$valid?e.money.customMoney>=100?e.getPayment({amount:e.money.customMoney,name:"Custom"}):e.showMessage("Minimum amount Rs.100"):e.showMessage("Please enter valid amount")},localStorage.getItem("packs")?e.packs=JSON.parse(localStorage.getItem("packs")):"user"==e.loginType&&o.getPacks().then(function(o){localStorage.setItem("packs",JSON.stringify(o)),e.packs=o},function(o){o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})}]),askmonkApp.controller("yProfileCtrl",["$scope","$state","$stateParams","utility","$timeout","CONSTANT","$ionicPopup",function(e,o,t,n,a,s,i){t.id?(e.$on("$ionicView.beforeEnter",function(){e.showLoader()}),e.loginType=s.loginType,n.getSingleMonk(t.id).then(function(o){e.hideLoader(),e.monkProfileData=o},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")}),e.askQuestion=function(){if(e.monkProfileData.isAvailable)localStorage.setItem("directQuestion",JSON.stringify({monkId:e.monkProfileData.id,monkName:e.monkProfileData.name,monkEmail:e.monkProfileData.email,isDirect:!0})),o.go("app.askQuestion");else{var t=i.show({cssClass:"ios",title:"Monk is not available right now. Please try again after some time or post open question.",buttons:[{text:"Yes",type:"button-ios button-clear",onTap:function(e){return!0}},{text:"No",type:"button-ios button-clear noBold",onTap:function(e){return!1}}]});t.then(function(e){e?(console.log("You are sure"),o.go("app.askQuestion")):console.log("You are not sure")})}}):o.go("app.yprofiles")}]),askmonkApp.controller("yProfilesCtrl",["$scope","$state","utility","$stateParams","CONSTANT","$timeout",function(e,o,t,n,a,s){e.loginType=a.loginType,e.showFilterMenu=!1,e.sortedFilterValue=!0,e.sortedFilter="rating",sessionStorage.monksProfiles?(e.monksProfiles=JSON.parse(sessionStorage.monksProfiles),t.getAllMonksCount().then(function(o){for(var t=0;t<e.monksProfiles.length;t++)for(var n in o)if(e.monksProfiles[t].id==n){e.monksProfiles[t].questionsAnswered=o[n][0],e.monksProfiles[t].profileViews=o[n][1];break}},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again."),sessionStorage.removeItem("monksProfiles")})):(e.showLoader(),t.getAllMonks().then(function(o){e.hideLoader(),e.monksProfiles=o,sessionStorage.setItem("monksProfiles",JSON.stringify(o))},function(o){e.hideLoader(),o&&422==o.error.statusCode?e.showMessage(o.error.message):e.showMessage("Something went wrong. Please try again.")})),e.goToYogiProfile=function(e){n.id=e,o.go("app.yprofile",n)},e.askQuestion=function(){o.go("app.askQuestion")},e.showFilter=function(){e.showFilterMenu=!0},e.closeFilterMenu=function(){e.showFilterMenu=!1},e.sortFilter=function(o){"name"==o?e.sortedFilterValue=e.sortedFilter===o?!e.sortedFilterValue:!1:e.sortedFilterValue=e.sortedFilter===o?!e.sortedFilterValue:!0,e.sortedFilter=o,e.showFilterMenu=!1}}]),askmonkApp.factory("base64Encoding",function(){var e={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(o){var t,n,a,s,i,r,l,u="",c=0;for(o=e._utf8_encode(o);c<o.length;)t=o.charCodeAt(c++),n=o.charCodeAt(c++),a=o.charCodeAt(c++),s=t>>2,i=(3&t)<<4|n>>4,r=(15&n)<<2|a>>6,l=63&a,isNaN(n)?r=l=64:isNaN(a)&&(l=64),u=u+this._keyStr.charAt(s)+this._keyStr.charAt(i)+this._keyStr.charAt(r)+this._keyStr.charAt(l);return u},decode:function(o){var t,n,a,s,i,r,l,u="",c=0;for(o=o.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<o.length;)s=this._keyStr.indexOf(o.charAt(c++)),i=this._keyStr.indexOf(o.charAt(c++)),r=this._keyStr.indexOf(o.charAt(c++)),l=this._keyStr.indexOf(o.charAt(c++)),t=s<<2|i>>4,n=(15&i)<<4|r>>2,a=(3&r)<<6|l,u+=String.fromCharCode(t),64!=r&&(u+=String.fromCharCode(n)),64!=l&&(u+=String.fromCharCode(a));return u=e._utf8_decode(u)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var o="",t=0;t<e.length;t++){var n=e.charCodeAt(t);128>n?o+=String.fromCharCode(n):n>127&&2048>n?(o+=String.fromCharCode(n>>6|192),o+=String.fromCharCode(63&n|128)):(o+=String.fromCharCode(n>>12|224),o+=String.fromCharCode(n>>6&63|128),o+=String.fromCharCode(63&n|128))}return o},_utf8_decode:function(e){for(var o="",t=0,n=c1=c2=0;t<e.length;)n=e.charCodeAt(t),128>n?(o+=String.fromCharCode(n),t++):n>191&&224>n?(c2=e.charCodeAt(t+1),o+=String.fromCharCode((31&n)<<6|63&c2),t+=2):(c2=e.charCodeAt(t+1),c3=e.charCodeAt(t+2),o+=String.fromCharCode((15&n)<<12|(63&c2)<<6|63&c3),t+=3);return o}};return e}),askmonkApp.factory("getMoonSign",function(){return function(e){var o=["capricorn","aquarius","pisces","aries","taurus","gemini","cancer","leo","virgo","libra","scorpio","sagittarius"];if(e.dob)var t=new Date(e.dob);else if(e.partnerDOB)var t=new Date(e.partnerDOB);else if(e.userDOB)var t=new Date(e.userDOB);var n=t.getDate(),a=t.getMonth();switch(a){case 0:20>n?e.moonSign=o[0]:e.moonSign=o[1];break;case 1:19>n?e.moonSign=o[1]:e.moonSign=o[2];break;case 2:21>n?e.moonSign=o[2]:e.moonSign=o[3];break;case 3:20>n?e.moonSign=o[3]:e.moonSign=o[4];break;case 4:21>n?e.moonSign=o[4]:e.moonSign=o[5];break;case 5:21>n?e.moonSign=o[5]:e.moonSign=o[6];break;case 6:23>n?e.moonSign=o[6]:e.moonSign=o[7];break;case 7:23>n?e.moonSign=o[7]:e.moonSign=o[8];break;case 8:23>n?e.moonSign=o[8]:e.moonSign=o[9];break;case 9:23>n?e.moonSign=o[9]:e.moonSign=o[10];break;case 10:22>n?e.moonSign=o[10]:e.moonSign=o[11];break;case 11:22>n?e.moonSign=o[11]:e.moonSign=o[0]}return e}}),askmonkApp.service("HardwareBackButtonManager",["$ionicPlatform",function(e){return this.deregister=void 0,this.disable=function(){this.deregister=e.registerBackButtonAction(function(e){return e.preventDefault(),!1},101)},this.enable=function(){void 0!==this.deregister&&(this.deregister(),this.deregister=void 0)},this}]),askmonkApp.service("utility",["$q","$http","$state",function e(o,t,n){var a={authenticated:null,request:function(e){localStorage.getItem("token")&&(t.defaults.headers.common.Authorization="Basic "+localStorage.getItem("token")),i=e.params||{},e=e||{};var n=o.defer(),a=this.API_URL+e.url,s=e.method||"GET",i=i,r=e.data||{};return t({url:a,withCredentials:this.use_session,method:s.toUpperCase(),params:i,data:r,timeout:9e4}).success(angular.bind(this,function(e,o,t,a){n.resolve(e,o)})).error(angular.bind(this,function(e,o,t,a){n.reject(e,o)})),n.promise},register:function(e){return this.request({method:"POST",url:"/api/users/",data:e})},login:function(o){return this.request({method:"POST",url:"/api/users/login/",data:o}).then(function(o){e.use_session||(t.defaults.headers.common.Authorization="Basic "+o.id,localStorage.setItem("token",o.id),localStorage.setItem("userId",o.userId))})},googleOauth:function(e){return this.request({method:"POST",url:"/googleOAuthLogin/",params:e})},facebookOauth:function(e){return this.request({method:"POST",url:"/fbOAuthLogin/",params:e})},logout:function(){return this.request({method:"POST",url:"/api/users/logout",params:{access_token:localStorage.getItem("token")}})},changeUserPassword:function(e){return this.request({method:"POST",url:"/api/users/changePassword/"+localStorage.getItem("token")+"/"+localStorage.getItem("email"),data:e})},forgetUserPassword:function(e){return this.request({method:"POST",url:"/request-password-reset/user/"+e})},resendValidationUser:function(e){return this.request({method:"POST",url:"/resendValidationEmail/"+e})},getAllQuestion:function(){return this.request({method:"GET",url:"/api/questions/tagQuestions",params:{access_token:localStorage.getItem("token")}})},getUserQuestions:function(){return this.request({method:"GET",url:"/api/questions/getQuestions/"+localStorage.getItem("userId"),params:{access_token:localStorage.getItem("token")}})},getSingleQuestions:function(e){return this.request({method:"GET",url:"/api/questions/findQuestion/"+e,params:{access_token:localStorage.getItem("token")}})},getUserProfile:function(e){return this.request({method:"GET",url:"/api/users/findUser/"+e,params:{access_token:localStorage.getItem("token")}})},updateUserProfile:function(e){return this.request({method:"PUT",url:"/api/users/"+localStorage.getItem("userId"),data:e,params:{access_token:localStorage.getItem("token")}})},askQuestion:function(e){return this.request({method:"POST",url:"/api/questions/askQuestion",data:e,params:{access_token:localStorage.getItem("token")}})},editQuestion:function(e){return this.request({method:"POST",url:"/api/questions/editQuestion",data:e,params:{access_token:localStorage.getItem("token")}})},askDirectQuestion:function(e){return this.request({method:"POST",url:"/api/questions/askDirect",data:e,params:{access_token:localStorage.getItem("token")}})},getPacks:function(){return this.request({method:"GET",url:"/api/payments/packs",params:{access_token:localStorage.getItem("token")}})},getAllMonks:function(){return this.request({method:"GET",url:"/api/monks",params:{access_token:localStorage.getItem("token")}})},getAllMonksCount:function(){return this.request({method:"GET",url:"/api/monks/getCountsForAllMonks",params:{access_token:localStorage.getItem("token")}})},getSingleMonk:function(e){return this.request({method:"GET",url:"/api/monks/getMonkDetails/"+e,params:{access_token:localStorage.getItem("token")}})},ratingQuestion:function(e){return this.request({method:"POST",url:"/api/users/rateAnswerByUser",data:e,params:{access_token:localStorage.getItem("token")}})},getUserCount:function(){return this.request({method:"GET",url:"/api/users/getCounts/"+localStorage.getItem("userId"),params:{access_token:localStorage.getItem("token")}})},getTimeLineJson:function(){return this.request({method:"GET",url:"/api/questions/timeLineJson",params:{access_token:localStorage.getItem("token")}})},getHoroscope:function(e){return this.request({method:"GET",url:"/api/horoscopes/findHoroscope/"+e})},userPaymentInfo:function(){return this.request({method:"GET",url:"/api/payments/findPayments/"+localStorage.getItem("userId"),params:{access_token:localStorage.getItem("token")}})},getbroadcastArticle:function(e){return this.request({method:"GET",url:"/api/articles/broadcastArticles/"+e,params:{access_token:localStorage.getItem("token")}})},getSingleBroadcastArticle:function(e){return this.request({method:"GET",url:"/api/articles/findArticle/"+e,params:{access_token:localStorage.getItem("token")}})},getFullPackages:function(){return this.request({method:"GET",url:"/api/questions/fullPackages",params:{access_token:localStorage.getItem("token")}})},postQuestionPackages:function(e){return this.request({method:"POST",url:"/api/questions/askFullAnalysis",data:e,params:{access_token:localStorage.getItem("token")}})},postAnswerInformation:function(e){return this.request({method:"POST",url:"/api/questions/answerInformationOnQuestion/",data:e,params:{access_token:localStorage.getItem("token")}})},notification:function(e){return this.request({method:"POST",url:"/api/notifications/registerDevice",data:e,params:{access_token:localStorage.getItem("token")}})},updateMonkAvailableStatus:function(e){return this.request({method:"POST",url:"/api/monks/availableStatus",data:e,params:{access_token:localStorage.getItem("token")}})},monkLogin:function(o){return this.request({method:"POST",url:"/api/monks/login/",data:o}).then(function(o){e.use_session||(t.defaults.headers.common.Authorization="Basic "+o.id,localStorage.setItem("token",o.id),localStorage.setItem("userId",o.userId))})},forgetMonkPassword:function(e){return this.request({method:"POST",url:"/request-password-reset/monk/"+e})},getMonkProfile:function(){return this.request({method:"GET",url:"/api/monks/findMonk/"+localStorage.getItem("userId"),params:{access_token:localStorage.getItem("token")}})},updateMonkProfile:function(e){return this.request({method:"PUT",url:"/api/monks/"+localStorage.getItem("userId"),data:e,params:{access_token:localStorage.getItem("token")}})},getQuestionOnStatus:function(e,o){return this.request({method:"GET",url:"/api/questions/getStatusQuestions/"+e+"/"+o,params:{access_token:localStorage.getItem("token")}})},getMonkAnsweredQuestion:function(e){return this.request({method:"GET",url:"/api/questions/findMonkQuestions/"+localStorage.getItem("userId")+"/"+e,params:{access_token:localStorage.getItem("token")}})},acceptQuestionMonk:function(e){return this.request({method:"POST",url:"/api/questions/acceptQuestion/",data:e,params:{access_token:localStorage.getItem("token")}})},submitAnswer:function(e){return this.request({method:"POST",url:"/api/monks/answerQuestion/",data:e,params:{access_token:localStorage.getItem("token")}})},getDirectQuestion:function(e){return this.request({method:"GET",url:"/api/questions/directQuestions/"+localStorage.getItem("userId")+"/"+e,params:{access_token:localStorage.getItem("token")}})},changeMonkPassword:function(e){return this.request({method:"POST",url:"/api/monks/changeMonkPassword/"+localStorage.getItem("token")+"/"+localStorage.getItem("email"),data:e})},addMoney:function(e){return this.request({method:"POST",url:"/api/payments/addMoney/",data:e,params:{access_token:localStorage.getItem("token")}})},getMonkCount:function(){return this.request({method:"GET",url:"/api/monks/getCounts/"+localStorage.getItem("userId"),params:{access_token:localStorage.getItem("token")}})},directQuestionsPending:function(){return this.request({method:"GET",url:"/api/monks/directQuestionsPending/"+localStorage.getItem("userId"),params:{access_token:localStorage.getItem("token")}})},getDirectQuestionCount:function(){return this.request({method:"GET",url:"/api/questions/count?where[status]=direct&where[monkId]="+localStorage.getItem("userId"),params:{access_token:localStorage.getItem("token")}})},monkPaymentInfo:function(){return this.request({method:"GET",url:"/api/monkPayments/findPayments/"+localStorage.getItem("userId"),params:{access_token:localStorage.getItem("token")}})},monkDraftQuestion:function(){return this.request({method:"GET",url:"/api/questions/getMonkStatusQuestions/"+localStorage.getItem("userId")+"/underObservation",params:{access_token:localStorage.getItem("token")}})},postInformation:function(e){return this.request({method:"POST",url:"/api/questions/askInformationOnQuestion/",data:e,params:{access_token:localStorage.getItem("token")}})},initialize:function(o,t,n,a){this.API_URL=o,this.use_session=t,n&&(n.authenticated=null,null==this.authenticated?localStorage.getItem("token")?(e.authenticated=!0,n.authenticated=!0,a.token=localStorage.getItem("token")):(e.authenticated=!1,n.authenticated=!1):n.authenticated=this.authenticated,n.setAuth=function(e){n.authenticated=e})}};return a}]),askmonkApp.directive("focusMe",["$timeout","$ionicScrollDelegate",function(e,o){return{link:function(t,n,a){e(function(){n[0].focus(),e(function(){o.$getByHandle("scrollHandle").resize(),o.$getByHandle("scrollHandle").scrollBottom(!0)},200)},100)}}}]),askmonkApp.directive("writeAnswer",["$timeout",function(e){return{link:function(o,t,n){e(function(){t[0].focus()},420)}}}]),askmonkApp.filter("timeago",function(){return function(e,o,t){if(!e)return"never";if(o||(o=Date.now()),angular.isDate(e)?e=e.getTime():"string"==typeof e&&(e=new Date(e).getTime()),angular.isDate(o)?o=o.getTime():"string"==typeof o&&(o=new Date(o).getTime()),"number"==typeof e&&"number"==typeof o){var n=Math.abs((o-e)/1e3),a=[],s=60,i=3600,r=86400,l=604800,u=31556926,c=315569260;return a=s>=n?["",t?"now":"a minute"]:60*s>n?[Math.round(Math.abs(n/s)),"min"]:24*i>n?[Math.round(Math.abs(n/i)),"hr"]:7*r>n?[Math.round(Math.abs(n/r)),"day"]:52*l>n?[Math.round(Math.abs(n/l)),"week"]:10*u>n?[Math.round(Math.abs(n/u)),"year"]:100*c>n?[Math.round(Math.abs(n/c)),"decade"]:["","a long time"],
a[1]+=0===a[0]||a[0]>1?"s":"",a=a.join(" "),t===!0?a:o>=e?a+" ago":"in "+a}}}),askmonkApp.directive("nxEqual",function(){return{require:"ngModel",link:function(e,o,t,n){return t.nxEqual?(e.$watch(t.nxEqual,function(e){n.$setValidity("nxEqual",e===n.$viewValue)}),void n.$parsers.push(function(o){var a=o===e.$eval(t.nxEqual);return n.$setValidity("nxEqual",a),a?o:void 0})):void console.error("nxEqual expects a model as an argument!")}}}),askmonkApp.directive("embedSrc",function(){return{restrict:"A",link:function(e,o,t){var n=o;e.$watch(function(){return t.embedSrc},function(){var e=o.clone().attr("src",t.embedSrc);n.replaceWith(e),n=e})}}}),askmonkApp.directive("lazyScroll",["$rootScope","$timeout",function(e,o){return{restrict:"A",link:function(t,n){var a=0;t.invoke=function(){e.$broadcast("lazyScrollEvent")},n.bind("scroll",function(){o.cancel(a),a=o(t.invoke,0)})}}}]),askmonkApp.directive("imageLazySrc",["$document","$timeout","$ionicScrollDelegate","$compile",function(e,o,t,n){return{restrict:"A",scope:{lazyScrollResize:"@lazyScrollResize",imageLazyBackgroundImage:"@imageLazyBackgroundImage"},link:function(a,s,i){function r(){if(s.bind("load",function(e){i.imageLazyLoader&&u.remove(),"true"==a.lazyScrollResize&&t.resize()}),"true"==a.imageLazyBackgroundImage){var e=new Image;e.onload=function(){i.imageLazyLoader&&u.remove(),s[0].style.backgroundImage="url("+i.imageLazySrc+")","true"==a.lazyScrollResize&&t.resize()},e.src=i.imageLazySrc}else s[0].src=i.imageLazySrc}function l(){var o=e[0].documentElement.clientHeight,t=e[0].documentElement.clientWidth,n=s[0].getBoundingClientRect();return n.top>=0&&n.top<=o+parseInt(i.imageLazyDistanceFromBottomToLoad)&&n.left>=0&&n.left<=t+parseInt(i.imageLazyDistanceFromRightToLoad)}if(i.imageLazyDistanceFromBottomToLoad||(i.imageLazyDistanceFromBottomToLoad=0),i.imageLazyDistanceFromRightToLoad||(i.imageLazyDistanceFromRightToLoad=0),i.imageLazyLoader){var u=n('<div class="image-loader-container"><ion-spinner class="image-loader" icon="'+i.imageLazyLoader+'"></ion-spinner></div>')(a);s.after(u)}var c=a.$on("lazyScrollEvent",function(){l()&&(r(),c())});s.on("$destroy",function(){c()}),o(function(){l()&&(r(),c())},500)}}}]),askmonkApp.directive("ellipsis",["$timeout","$window","$sce",function(e,o,t){var n=function(o){var t=null,n=[];this.remove=function(o){-1!==n.indexOf(o)&&(n.splice(n.indexOf(o),1),0===n.length&&(e.cancel(t),t=null))},this.add=function(a){-1===n.indexOf(a)&&n.push(a),t||(t=e(function(){var e=n.slice();t=null,n.length=0,e.forEach(function(e){e()})},o))}},a=new n(0),s=new n(75);return{restrict:"A",scope:{ngBind:"=",ngBindHtml:"=",ellipsisAppend:"@",ellipsisAppendClick:"&",ellipsisSymbol:"@",ellipsisSeparator:"@",useParent:"@",ellipsisSeparatorReg:"="},compile:function(e,n,i){return function(e,n,i){function r(e){var o=0;return angular.forEach(e.parent().children(),function(t){t!=e[0]&&(o+=t.clientHeight)}),e.parent()[0].clientHeight-o}function l(){var o=e.ngBind||e.ngBindHtml,a=!1;if(t.isEnabled()&&angular.isObject(o)&&t.getTrustedHtml(o)&&(a=!0,o=t.getTrustedHtml(o)),o){var s=!e.ngBind&&!!e.ngBindHtml,l=0,c="undefined"!=typeof i.ellipsisSymbol?i.ellipsisSymbol:"&hellip;",g="undefined"!=typeof e.ellipsisSeparator?i.ellipsisSeparator:" ",d="undefined"!=typeof e.ellipsisSeparatorReg?e.ellipsisSeparatorReg:!1,m="undefined"!=typeof e.ellipsisAppend&&""!==e.ellipsisAppend?c+"<span>"+e.ellipsisAppend+"</span>":c,p=d?o.match(d):o.split(g);if(i.isTruncated=!1,s?n.html(o):n.text(o),u(n,e.useParent)){var h=p.length,f=e.useParent?r(n):n[0].clientHeight;for(s?n.html(o+m):n.text(o).html(n.html()+m),n.attr("data-overflowed","true");h>l;l++)if(p.pop(),s?n.html(p.join(g)+m):n.text(p.join(g)).html(n.html()+m),(e.useParent?n.parent()[0]:n[0]).scrollHeight<f||u(n,e.useParent)===!1){i.isTruncated=!0;break}c!=m&&"undefined"!=typeof e.ellipsisAppendClick&&""!==e.ellipsisAppendClick&&n.find("span").bind("click",function(o){e.$apply(function(){e.ellipsisAppendClick.call(e,{event:o})})}),!a&&t.isEnabled()&&t.trustAsHtml(o)}}}function u(e,o){return e=o?e.parent():e,e[0].scrollHeight>e[0].clientHeight}function c(){(i.lastWindowResizeWidth!=window.innerWidth||i.lastWindowResizeHeight!=window.innerHeight)&&l(),i.lastWindowResizeWidth=window.innerWidth,i.lastWindowResizeHeight=window.innerHeight}function g(){s.add(c)}i.lastWindowResizeTime=0,i.lastWindowResizeWidth=0,i.lastWindowResizeHeight=0,i.lastWindowTimeoutEvent=null,i.isTruncated=!1,e.$watch("ngBind",function(){a.add(l)}),e.$watch("ngBindHtml",function(){a.add(l)}),e.$watch("ellipsisAppend",function(){l()});var d=angular.element(o);d.bind("resize",g),e.$on("$destroy",function(){d.unbind("resize",g),a.remove(l),s.remove(c)})}}}}]),askmonkApp.filter("ageFilter",function(){function e(e){if(e){e=new Date(e);var o=Date.now()-e.getTime(),t=new Date(o);return Math.abs(t.getUTCFullYear()-1970)}}return function(o){return e(o)}}),askmonkApp.filter("getEducation",function(){return function(e){return console.log(e),"10"==e||"12"==e?e+"th":e}}),askmonkApp.filter("capitalize",function(){return function(e){return e?e.charAt(0).toUpperCase()+e.substr(1).toLowerCase():""}});